shadow$provide.module$node_modules$$codemirror$view$dist$index_cjs=function(global,require,module,exports){function getSelection(root){return root.getSelection?root.getSelection():document.getSelection()}function contains(dom,node){return node?dom.contains(1!=node.nodeType?node.parentNode:node):!1}function hasSelection(dom,selection){if(!selection.anchorNode)return!1;try{return contains(dom,selection.anchorNode)}catch(_){return!1}}function clientRectsFor(dom){return 3==dom.nodeType?textRange(dom,
0,dom.nodeValue.length).getClientRects():1==dom.nodeType?dom.getClientRects():[]}function isEquivalentPosition(node,off,targetNode,targetOff){return targetNode?scanFor(node,off,targetNode,targetOff,-1)||scanFor(node,off,targetNode,targetOff,1):!1}function domIndex(node){for(var index=0;;index++)if(node=node.previousSibling,!node)return index}function scanFor(node,off,targetNode,targetOff,dir){for(;;){if(node==targetNode&&off==targetOff)return!0;if(off==(0>dir?0:maxOffset(node))){if("DIV"==node.nodeName)return!1;
let parent=node.parentNode;if(!parent||1!=parent.nodeType)return!1;off=domIndex(node)+(0>dir?0:1);node=parent}else if(1==node.nodeType)node=node.childNodes[off+(0>dir?-1:0)],off=0>dir?maxOffset(node):0;else return!1}}function maxOffset(node){return 3==node.nodeType?node.nodeValue.length:node.childNodes.length}function flattenRect(rect,left){left=left?rect.left:rect.right;return{left,right:left,top:rect.top,bottom:rect.bottom}}function focusPreventScroll(dom){if(dom.setActive)return dom.setActive();
if(preventScrollSupported)return dom.focus(preventScrollSupported);let stack=[];for(var cur=dom;cur&&(stack.push(cur,cur.scrollTop,cur.scrollLeft),cur!=cur.ownerDocument);cur=cur.parentNode);dom.focus(null==preventScrollSupported?{get preventScroll(){preventScrollSupported={preventScroll:!0};return!0}}:void 0);if(!preventScrollSupported)for(preventScrollSupported=!1,dom=0;dom<stack.length;){cur=stack[dom++];let top=stack[dom++],left=stack[dom++];cur.scrollTop!=top&&(cur.scrollTop=top);cur.scrollLeft!=
left&&(cur.scrollLeft=left)}}function textRange(node,from,to=from){let range=scratchRange||(scratchRange=document.createRange());range.setEnd(node,to);range.setStart(node,from);return range}function dispatchKey(elt,name,code){code={key:name,code:name,keyCode:code,which:code,cancelable:!0};name=new KeyboardEvent("keydown",code);name.synthetic=!0;elt.dispatchEvent(name);code=new KeyboardEvent("keyup",code);code.synthetic=!0;elt.dispatchEvent(code);return name.defaultPrevented||code.defaultPrevented}
function rm(dom){let next=dom.nextSibling;dom.parentNode.removeChild(dom);return next}function textCoords(text,pos,side){let length=text.nodeValue.length;pos>length&&(pos=length);let from=pos,to=pos,flatten=0;0==pos&&0>side||pos==length&&0<=side?browser.chrome||browser.gecko||(pos?(from--,flatten=1):(to++,flatten=-1)):0>side?from--:to++;text=textRange(text,from,to).getClientRects();if(!text.length)return Rect0;side=text[(flatten?0>flatten:0<=side)?0:text.length-1];browser.safari&&!flatten&&0==side.width&&
(side=Array.prototype.find.call(text,r=>r.width)||side);return flatten?flattenRect(side,0>flatten):side}function mergeInlineChildren(parent,from,to,elts,openStart,openEnd){let cur=parent.childCursor(),{i:toI,off:toOff}=cur.findPos(to,1),{i:fromI,off:fromOff}=cur.findPos(from,-1);from-=to;for(var view of elts)from+=view.length;parent.length+=from;({children:view}=parent);if(fromI==toI&&fromOff){from=view[fromI];if(1==elts.length&&from.merge(fromOff,toOff,elts[0],openStart,openEnd))return;if(0==elts.length){from.merge(fromOff,
toOff,null,openStart,openEnd);return}from=from.slice(toOff);from.merge(0,0,elts[elts.length-1],0,openEnd)?elts[elts.length-1]=from:elts.push(from);toI++;openEnd=toOff=0}toOff?(from=view[toI],elts.length&&from.merge(0,toOff,elts[elts.length-1],0,openEnd)?(elts.pop(),openEnd=elts.length?0:openStart):from.merge(0,toOff,null,0,0)):toI<view.length&&elts.length&&view[toI].merge(0,0,elts[elts.length-1],0,openEnd)&&(elts.pop(),openEnd=elts.length?0:openStart);fromOff?(from=view[fromI],elts.length&&from.merge(fromOff,
from.length,elts[0],openStart,0)?(elts.shift(),openStart=elts.length?0:openEnd):from.merge(fromOff,from.length,null,0,0),fromI++):fromI&&elts.length&&(from=view[fromI-1],from.merge(from.length,from.length,elts[0],openStart,0)&&(elts.shift(),openStart=elts.length?0:openEnd));for(;fromI<toI&&elts.length&&view[toI-1].become(elts[elts.length-1]);)elts.pop(),toI--,openEnd=elts.length?0:openStart;for(;fromI<toI&&elts.length&&view[fromI].become(elts[0]);)elts.shift(),fromI++,openStart=elts.length?0:openEnd;
!elts.length&&fromI&&toI<view.length&&openStart&&openEnd&&view[toI].merge(0,0,view[fromI-1],openStart,openEnd)&&fromI--;(elts.length||fromI!=toI)&&parent.replaceChildren(fromI,toI,elts)}function inlineDOMAtPos(dom,children,pos){let i=0;for(let off=0;i<children.length;i++){let child=children[i],end=off+child.length;if(!(end==off&&0>=child.getSide())){if(pos>off&&pos<end&&child.dom.parentNode==dom)return child.domAtPos(pos-off);if(pos<=off)break;off=end}}for(;0<i;i--)if(pos=children[i-1].dom,pos.parentNode==
dom)return DOMPos.after(pos);return new DOMPos(dom,0)}function joinInlineInto(parent,view,open){let last,{children}=parent;0<open&&view instanceof MarkView&&children.length&&(last=children[children.length-1])instanceof MarkView&&last.mark.eq(view.mark)?joinInlineInto(last,view.children[0],open-1):(children.push(view),view.setParent(parent));parent.length+=view.length}function coordsInChildren(view,pos,side){for(let off=0,i=0;i<view.children.length;i++){let child=view.children[i],end=off+child.length;
if(!(end==off&&0>=child.getSide())){if(0>=side||end==view.length?end>=pos:end>pos)return child.coordsAt(pos-off,side);off=end}}pos=view.dom.lastChild;if(!pos)return view.dom.getBoundingClientRect();view=clientRectsFor(pos);return view[view.length-1]}function combineAttrs(source,target){for(let name in source)"class"==name&&target.class?target.class+=" "+source.class:"style"==name&&target.style?target.style+=";"+source.style:target[name]=source[name];return target}function attrsEq(a,b){if(a==b)return!0;
if(!a||!b)return!1;let keysA=Object.keys(a),keysB=Object.keys(b);if(keysA.length!=keysB.length)return!1;for(let key of keysA)if(-1==keysB.indexOf(key)||a[key]!==b[key])return!1;return!0}function updateAttrs(dom,prev,attrs){if(prev)for(let name in prev)attrs&&name in attrs||dom.removeAttribute(name);if(attrs)for(let name in attrs)prev&&prev[name]==attrs[name]||dom.setAttribute(name,attrs[name])}function getInclusive(spec){let {inclusiveStart:start,inclusiveEnd:end}=spec;null==start&&(start=spec.inclusive);
null==end&&(end=spec.inclusive);return{start:start||!1,end:end||!1}}function addRange(from,to,ranges,margin=0){let last=ranges.length-1;0<=last&&ranges[last]+margin>from?ranges[last]=Math.max(ranges[last],to):ranges.push(from,to)}function logException(state,exception,context){state=state.facet(exceptionSink);if(state.length)state[0](exception);else if(window.onerror)window.onerror(String(exception),context,void 0,void 0,exception);else context?console.error(context+":",exception):console.error(exception)}
function computeCompositionDeco(view,changes){var sel=view.observer.selectionRange;sel=sel.focusNode&&nearbyTextNode(sel.focusNode,sel.focusOffset,0);if(!sel)return Decoration.none;var cView=view.docView.nearest(sel);let from;let topNode=sel;if(cView instanceof InlineView){for(;cView.parent instanceof InlineView;)cView=cView.parent;from=cView.posAtStart;var to=from+cView.length;topNode=cView.dom}else if(cView instanceof LineView){for(;topNode.parentNode!=cView.dom;)topNode=topNode.parentNode;for(to=
topNode.previousSibling;to&&!ContentView.get(to);)to=to.previousSibling;from=to=to?ContentView.get(to).posAtEnd:cView.posAtStart}else return Decoration.none;cView=changes.mapPos(from,1);changes=Math.max(cView,changes.mapPos(to,-1));to=sel.nodeValue;({state:view}=view);if(changes-cView<to.length)if(view.sliceDoc(cView,Math.min(view.doc.length,cView+to.length))==to)changes=cView+to.length;else if(view.sliceDoc(Math.max(0,changes-to.length),changes)==to)cView=changes-to.length;else return Decoration.none;
else if(view.sliceDoc(cView,changes)!=to)return Decoration.none;return Decoration.set(Decoration.replace({widget:new CompositionWidget(topNode,sel)}).range(cView,changes))}function nearbyTextNode(node,offset,side){for(;;){if(3==node.nodeType)return node;if(1==node.nodeType&&0<offset&&0>=side)node=node.childNodes[offset-1],offset=maxOffset(node);else if(1==node.nodeType&&offset<node.childNodes.length&&0<=side)node=node.childNodes[offset],offset=0;else return null}}function nextToUneditable(node,offset){return 1!=
node.nodeType?0:(offset&&"false"==node.childNodes[offset-1].contentEditable?1:0)|(offset<node.childNodes.length&&"false"==node.childNodes[offset].contentEditable?2:0)}function findChangedDeco(a,b,diff){let comp=new DecorationComparator$1;rangeset.RangeSet.compare(a,b,diff,comp);return comp.changes}function dec(str){let result=[];for(let i=0;i<str.length;i++)result.push(1<<+str[i]);return result}function computeOrder(line,direction){let len=line.length;var outerType=direction==LTR?1:2;direction=direction==
LTR?2:1;if(!line||1==outerType&&!BidiRE.test(line))return[new BidiSpan(0,len,0)];for(let i=0,prev=outerType,prevStrong=outerType;i<len;i++){var ch$jscomp$0=line.charCodeAt(i);ch$jscomp$0=247>=ch$jscomp$0?LowTypes[ch$jscomp$0]:1424<=ch$jscomp$0&&1524>=ch$jscomp$0?2:1536<=ch$jscomp$0&&1785>=ch$jscomp$0?ArabicTypes[ch$jscomp$0-1536]:1774<=ch$jscomp$0&&2220>=ch$jscomp$0?4:8192<=ch$jscomp$0&&8203>=ch$jscomp$0?256:8204==ch$jscomp$0?256:1;512==ch$jscomp$0?ch$jscomp$0=prev:8==ch$jscomp$0&&4==prevStrong&&
(ch$jscomp$0=16);types[i]=4==ch$jscomp$0?2:ch$jscomp$0;ch$jscomp$0&7&&(prevStrong=ch$jscomp$0);prev=ch$jscomp$0}for(let i=0,prev=outerType,prevStrong=outerType;i<len;i++){ch$jscomp$0=types[i];if(128==ch$jscomp$0)i<len-1&&prev==types[i+1]&&prev&24?ch$jscomp$0=types[i]=prev:types[i]=256;else if(64==ch$jscomp$0){for(var end=i+1;end<len&&64==types[end];)end++;var replace=i&&8==prev||end<len&&8==types[end]?1==prevStrong?1:8:256;for(let j=i;j<end;j++)types[j]=replace;i=end-1}else 8==ch$jscomp$0&&1==prevStrong&&
(types[i]=1);prev=ch$jscomp$0;ch$jscomp$0&7&&(prevStrong=ch$jscomp$0)}for(let i=0,sI=0,context=0,ch,br,type;i<len;i++)if(br=Brackets[ch=line.charCodeAt(i)])if(0>br)for(ch$jscomp$0=sI-3;0<=ch$jscomp$0;ch$jscomp$0-=3){if(BracketStack[ch$jscomp$0+1]==-br){end=BracketStack[ch$jscomp$0+2];(end=end&2?outerType:end&4?end&1?direction:outerType:0)&&(types[i]=types[BracketStack[ch$jscomp$0]]=end);sI=ch$jscomp$0;break}}else if(189==BracketStack.length)break;else BracketStack[sI++]=i,BracketStack[sI++]=ch,BracketStack[sI++]=
context;else if(2==(type=types[i])||1==type)for(context=(ch$jscomp$0=type==outerType)?0:1,end=sI-3;0<=end;end-=3){replace=BracketStack[end+2];if(replace&2)break;if(ch$jscomp$0)BracketStack[end+2]|=2;else{if(replace&4)break;BracketStack[end+2]|=4}}for(direction=0;direction<len;direction++)if(256==types[direction]){for(line=direction+1;line<len&&256==types[line];)line++;ch$jscomp$0=1==(direction?types[direction-1]:outerType);for(ch$jscomp$0=ch$jscomp$0==(1==(line<len?types[line]:outerType))?ch$jscomp$0?
1:2:outerType;direction<line;direction++)types[direction]=ch$jscomp$0;direction=line-1}line=[];if(1==outerType)for(outerType=0;outerType<len;){direction=outerType;for(ch$jscomp$0=1!=types[outerType++];outerType<len&&ch$jscomp$0==(1!=types[outerType]);)outerType++;if(ch$jscomp$0)for(ch$jscomp$0=outerType;ch$jscomp$0>direction;){end=ch$jscomp$0;for(replace=2!=types[--ch$jscomp$0];ch$jscomp$0>direction&&replace==(2!=types[ch$jscomp$0-1]);)ch$jscomp$0--;line.push(new BidiSpan(ch$jscomp$0,end,replace?
2:1))}else line.push(new BidiSpan(direction,outerType,0))}else for(outerType=0;outerType<len;){direction=outerType;for(ch$jscomp$0=2==types[outerType++];outerType<len&&ch$jscomp$0==(2==types[outerType]);)outerType++;line.push(new BidiSpan(direction,outerType,ch$jscomp$0?1:2))}return line}function moveVisually(line,order,dir,start,forward){var _a;let startIndex=start.head-line.from,spanI=-1;if(0==startIndex){if(!forward||!line.length)return null;order[0].level!=dir&&(startIndex=order[0].side(!1,dir),
spanI=0)}else if(startIndex==line.length){if(forward)return null;var last=order[order.length-1];last.level!=dir&&(startIndex=last.side(!0,dir),spanI=order.length-1)}0>spanI&&(spanI=BidiSpan.find(order,startIndex,null!==(_a=start.bidiLevel)&&void 0!==_a?_a:-1,start.assoc));start=order[spanI];startIndex==start.side(forward,dir)&&(start=order[spanI+=forward?1:-1],startIndex=start.side(!forward,dir));last=forward==(start.dir==dir);_a=text$jscomp$0.findClusterBreak(line.text,startIndex,last);movedOver=
line.text.slice(Math.min(startIndex,_a),Math.max(startIndex,_a));return _a!=start.side(forward,dir)?state$jscomp$0.EditorSelection.cursor(_a+line.from,last?-1:1,start.level):(order=spanI==(forward?order.length-1:0)?null:order[spanI+(forward?1:-1)])||start.level==dir?order&&order.level<start.level?state$jscomp$0.EditorSelection.cursor(order.side(!forward,dir)+line.from,forward?1:-1,order.level):state$jscomp$0.EditorSelection.cursor(_a+line.from,forward?-1:1,start.level):state$jscomp$0.EditorSelection.cursor(forward?
line.to:line.from,forward?-1:1,dir)}function groupAt(state$1,pos,bias=1){let categorize=state$1.charCategorizer(pos);state$1=state$1.doc.lineAt(pos);var linePos=pos-state$1.from;if(0==state$1.length)return state$jscomp$0.EditorSelection.cursor(pos);0==linePos?bias=1:linePos==state$1.length&&(bias=-1);let to=pos=linePos;0>bias?pos=text$jscomp$0.findClusterBreak(state$1.text,linePos,!1):to=text$jscomp$0.findClusterBreak(state$1.text,linePos);for(bias=categorize(state$1.text.slice(pos,to));0<pos;){linePos=
text$jscomp$0.findClusterBreak(state$1.text,pos,!1);if(categorize(state$1.text.slice(linePos,pos))!=bias)break;pos=linePos}for(;to<state$1.length;){linePos=text$jscomp$0.findClusterBreak(state$1.text,to);if(categorize(state$1.text.slice(to,linePos))!=bias)break;to=linePos}return state$jscomp$0.EditorSelection.range(pos+state$1.from,to+state$1.from)}function yOverlap(a,b){return a.top<b.bottom-1&&a.bottom>b.top+1}function upTop(rect,top){return top<rect.top?{top,left:rect.left,right:rect.right,bottom:rect.bottom}:
rect}function upBot(rect,bottom){return bottom>rect.bottom?{top:rect.top,left:rect.left,right:rect.right,bottom}:rect}function domPosAtCoords(parent,x,y){let closest,closestRect,closestX;let above,below,aboveRect,belowRect;for(let child=parent.firstChild;child;child=child.nextSibling){let rects=clientRectsFor(child);for(let i=0;i<rects.length;i++){let rect=rects[i];closestRect&&yOverlap(closestRect,rect)&&(rect=upTop(upBot(rect,closestRect.bottom),closestRect.top));let dx=rect.left>x?rect.left-x:
Math.max(0,x-rect.right),dy=rect.top>y?rect.top-y:Math.max(0,y-rect.bottom);if(0==dx&&0==dy)return 3==child.nodeType?domPosInText(child,x,y):domPosAtCoords(child,x,y);if(!closest||closestY>dy||closestY==dy&&closestX>dx){closest=child;closestRect=rect;closestX=dx;var closestY=dy}0==dx?y>rect.bottom&&(!aboveRect||aboveRect.bottom<rect.bottom)?(above=child,aboveRect=rect):y<rect.top&&(!belowRect||belowRect.top>rect.top)&&(below=child,belowRect=rect):aboveRect&&yOverlap(aboveRect,rect)?aboveRect=upBot(aboveRect,
rect.bottom):belowRect&&yOverlap(belowRect,rect)&&(belowRect=upTop(belowRect,rect.top))}}aboveRect&&aboveRect.bottom>=y?(closest=above,closestRect=aboveRect):belowRect&&belowRect.top<=y&&(closest=below,closestRect=belowRect);if(!closest)return{node:parent,offset:0};closestY=Math.max(closestRect.left,Math.min(closestRect.right,x));if(3==closest.nodeType)return domPosInText(closest,closestY,y);if(!closestX&&"true"==closest.contentEditable)return domPosAtCoords(closest,closestY,y);x=Array.prototype.indexOf.call(parent.childNodes,
closest)+(x>=(closestRect.left+closestRect.right)/2?1:0);return{node:parent,offset:x}}function domPosInText(node,x,y){let len=node.nodeValue.length;var closestOffset=-1,closestDY=1E9;let generalSide=0;for(let i=0;i<len;i++){let rects=textRange(node,i,i+1).getClientRects();for(let j=0;j<rects.length;j++){let rect=rects[j];if(rect.top==rect.bottom)continue;generalSide||(generalSide=x-rect.left);let dy=(rect.top>y?rect.top-y:y-rect.bottom)-1;if(rect.left-1<=x&&rect.right+1>=x&&dy<closestDY){closestDY=
closestOffset=x>=(rect.left+rect.right)/2;(browser.chrome||browser.gecko)&&textRange(node,i).getBoundingClientRect().left==rect.right&&(closestDY=!closestOffset);if(0>=dy)return{node,offset:i+(closestDY?1:0)};closestOffset=i+(closestDY?1:0);closestDY=dy}}}return{node,offset:-1<closestOffset?closestOffset:0<generalSide?node.nodeValue.length:0}}function posAtCoords(view,{x,y},bias=-1){var content=view.contentDOM.getBoundingClientRect(),halfLine=view.defaultLineHeight/2;for(let bounced=!1;;){var block=
view.blockAtHeight(y,content.top);if(block.top>y||block.bottom<y){bias=block.top>y?-1:1;y=Math.min(block.bottom-halfLine,Math.max(block.top+halfLine,y));if(bounced)return-1;bounced=!0}if(block.type==exports.BlockType.Text)break;y=0<bias?block.bottom+halfLine:block.top-halfLine}bias=block.from;if(bias<view.viewport.from)return 0==view.viewport.from?0:null;if(bias>view.viewport.to)return view.viewport.to==view.state.doc.length?view.state.doc.length:null;x=Math.max(content.left+1,Math.min(content.right-
1,x));block=view.root;halfLine=block.elementFromPoint(x,y);var node;content=-1;if(halfLine&&view.contentDOM.contains(halfLine)&&!(view.docView.nearest(halfLine)instanceof WidgetView))if(block.caretPositionFromPoint){var pos=block.caretPositionFromPoint(x,y);pos&&({offsetNode:node,offset:content}=pos)}else if(block.caretRangeFromPoint&&(block=block.caretRangeFromPoint(x,y))){({startContainer:node,startOffset:content}=block);if(block=browser.safari)a:if(block=x,3!=node.nodeType||content!=(pos=node.nodeValue.length))block=
!1;else{for(halfLine=node.nextSibling;halfLine;halfLine=node.nextSibling)if(1!=halfLine.nodeType||"BR"!=halfLine.nodeName){block=!1;break a}block=textRange(node,pos-1,pos).getBoundingClientRect().left>block}block&&(node=void 0)}node&&view.docView.dom.contains(node)||(node=LineView.find(view.docView,bias),{node,offset:content}=domPosAtCoords(node.dom,x,y));return view.docView.posFromDOM(node,content)}function moveByChar(view,start,forward,by){let line=view.state.doc.lineAt(start.head),spans=view.bidiSpans(line);
for(let cur=start,check=null;;){start=moveVisually(line,spans,view.textDirection,cur,forward);let char=movedOver;if(!start){if(line.number==(forward?view.state.doc.lines:1))return cur;char="\n";line=view.state.doc.line(line.number+(forward?1:-1));spans=view.bidiSpans(line);start=state$jscomp$0.EditorSelection.cursor(forward?line.from:line.to)}if(!check){if(!by)return start;check=by(char)}else if(!check(char))return cur;cur=start}}function byGroup(view,pos,start){let categorize=view.state.charCategorizer(pos),
cat=categorize(start);return next=>{next=categorize(next);cat==state$jscomp$0.CharCategory.Space&&(cat=next);return cat==next}}function isInPrimarySelection(view,event){var {main}=view.state.selection;if(main.empty)return!1;view=getSelection(view.root);if(0==view.rangeCount)return!0;view=view.getRangeAt(0).getClientRects();for(main=0;main<view.length;main++){let rect=view[main];if(rect.left<=event.clientX&&rect.right>=event.clientX&&rect.top<=event.clientY&&rect.bottom>=event.clientY)return!0}return!1}
function eventBelongsToEditor(view,event){if(!event.bubbles)return!0;if(event.defaultPrevented)return!1;for(let node=event.target,cView;node!=view.contentDOM;node=node.parentNode)if(!node||11==node.nodeType||(cView=ContentView.get(node))&&cView.ignoreEvent(event))return!1;return!0}function capturePaste(view){let parent=view.dom.parentNode;if(parent){var target=parent.appendChild(document.createElement("textarea"));target.style.cssText="position: fixed; left: -10000px; top: 10px";target.focus();setTimeout(()=>
{view.focus();target.remove();doPaste(view,target.value)},50)}}function doPaste(view,input){let {state:state$1}=view,changes,i=1,text=state$1.toText(input),byLine=text.lines==state$1.selection.ranges.length;if(lastLinewiseCopy&&state$1.selection.ranges.every(r=>r.empty)&&lastLinewiseCopy==text.toString()){let lastLine=-1;changes=state$1.changeByRange(range=>{let line=state$1.doc.lineAt(range.from);if(line.from==lastLine)return{range};lastLine=line.from;let insert=state$1.toText((byLine?text.line(i++).text:
input)+state$1.lineBreak);return{changes:{from:line.from,insert},range:state$jscomp$0.EditorSelection.cursor(range.from+insert.length)}})}else changes=byLine?state$1.changeByRange(range=>{let line=text.line(i++);return{changes:{from:range.from,to:range.to,insert:line.text},range:state$jscomp$0.EditorSelection.cursor(range.from+line.length)}}):state$1.replaceSelection(text);view.dispatch(changes,{annotations:state$jscomp$0.Transaction.userEvent.of("paste"),scrollIntoView:!0})}function rangeForClick(view,
pos,bias,type){if(1==type)return state$jscomp$0.EditorSelection.cursor(pos,bias);if(2==type)return groupAt(view.state,pos,bias);bias=LineView.find(view.docView,pos);pos=view.state.doc.lineAt(bias?bias.posAtEnd:pos);type=bias?bias.posAtStart:pos.from;bias=bias?bias.posAtEnd:pos.to;bias<view.state.doc.length&&bias==pos.to&&bias++;return state$jscomp$0.EditorSelection.range(type,bias)}function queryPos(view,event){var pos=view.posAtCoords({x:event.clientX,y:event.clientY});if(null==pos)pos=null;else{{var JSCompiler_inline_result=
event.clientX;event=event.clientY;let line=LineView.find(view.docView,pos);if(line){var off=pos-line.posAtStart;if(0==off)JSCompiler_inline_result=1;else if(off==line.length)JSCompiler_inline_result=-1;else{view=line.coordsAt(off,-1);var JSCompiler_temp;if(JSCompiler_temp=view)JSCompiler_temp=event>=view.top&&event<=view.bottom&&JSCompiler_inline_result>=view.left&&JSCompiler_inline_result<=view.right;if(JSCompiler_temp)JSCompiler_inline_result=-1;else{if(JSCompiler_temp=off=line.coordsAt(off,1))JSCompiler_temp=
event>=off.top&&event<=off.bottom&&JSCompiler_inline_result>=off.left&&JSCompiler_inline_result<=off.right;JSCompiler_inline_result=JSCompiler_temp?1:view&&event>=view.top&&event<=view.bottom?-1:1}}}else JSCompiler_inline_result=1}pos={pos,bias:JSCompiler_inline_result}}return pos}function getClickType(event){if(!BadMouseDetail)return event.detail;let last=lastMouseDown,lastTime=lastMouseDownTime;lastMouseDown=event;lastMouseDownTime=Date.now();return lastMouseDownCount=!last||lastTime>Date.now()-
400&&2>Math.abs(last.clientX-event.clientX)&&2>Math.abs(last.clientY-event.clientY)?(lastMouseDownCount+1)%3:1}function basicMouseSelection(view,event$jscomp$0){let start=queryPos(view,event$jscomp$0),type=getClickType(event$jscomp$0),startSel=view.state.selection,last=start,lastEvent=event$jscomp$0;return{update(update){update.changes&&(start&&(start.pos=update.changes.mapPos(start.pos)),startSel=startSel.map(update.changes))},get(event,extend,multiple){if(event.clientX==lastEvent.clientX&&event.clientY==
lastEvent.clientY)var cur=last;else cur=last=queryPos(view,event),lastEvent=event;if(!cur||!start)return startSel;event=rangeForClick(view,cur.pos,cur.bias,type);if(start.pos!=cur.pos&&!extend){var startRange=rangeForClick(view,start.pos,start.bias,type);cur=Math.min(startRange.from,event.from);startRange=Math.max(startRange.to,event.to);event=cur<event.from?state$jscomp$0.EditorSelection.range(cur,startRange):state$jscomp$0.EditorSelection.range(startRange,cur)}return extend?startSel.replaceRange(startSel.main.extend(event.from,
event.to)):multiple?startSel.addRange(event):state$jscomp$0.EditorSelection.create([event])}}}function dropText(view,event,text,direct){let dropPos=view.posAtCoords({x:event.clientX,y:event.clientY});null!=dropPos&&text&&(event.preventDefault(),{mouseSelection:event}=view.inputState,direct=direct&&event&&event.dragging&&event.dragMove?{from:event.dragging.from,to:event.dragging.to}:null,text={from:dropPos,insert:text},text=view.state.changes(direct?[direct,text]:text),view.focus(),view.dispatch({changes:text,
selection:{anchor:text.mapPos(dropPos,-1),head:text.mapPos(dropPos,1)},annotations:state$jscomp$0.Transaction.userEvent.of("drop")}))}function captureCopy(view,text){let parent=view.dom.parentNode;if(parent){var target=parent.appendChild(document.createElement("textarea"));target.style.cssText="position: fixed; left: -10000px; top: 10px";target.value=text;target.focus();target.selectionEnd=text.length;target.selectionStart=0;setTimeout(()=>{target.remove();view.focus()},50)}}function mergeGaps(nodes,
around){let before,after;null==nodes[around]&&(before=nodes[around-1])instanceof HeightMapGap&&(after=nodes[around+1])instanceof HeightMapGap&&nodes.splice(around-1,3,new HeightMapGap(before.length+1+after.length))}function lineStructure(from$jscomp$0,to$jscomp$0,state){let ranges=[],pos=from$jscomp$0,total=0;rangeset.RangeSet.spans(state.facet(decorations),from$jscomp$0,to$jscomp$0,{span(){},point(from,to){from>pos&&(ranges.push({from:pos,to:from}),total+=from-pos);pos=to}},20);pos<to$jscomp$0&&
(ranges.push({from:pos,to:to$jscomp$0}),total+=to$jscomp$0-pos);return{total,ranges}}function findPosition({total,ranges},ratio){if(0>=ratio)return ranges[0].from;if(1<=ratio)return ranges[ranges.length-1].to;total=Math.floor(total*ratio);for(ratio=0;;ratio++){let {from,to}=ranges[ratio],size=to-from;if(total<=size)return from+total;total-=size}}function findFraction(structure,pos){let counted=0;for(let {from,to}of structure.ranges){if(pos<=to){counted+=pos-from;break}counted+=to-from}return counted/
structure.total}function find(array,f){for(let val of array)if(f(val))return val}function scaleBlock(block,scaler,top){if(1==scaler.scale)return block;let bTop=scaler.toDOM(block.top,top),bBottom=scaler.toDOM(block.bottom,top);return new BlockInfo(block.from,block.length,bTop,bBottom-bTop,Array.isArray(block.type)?block.type.map(b=>scaleBlock(b,scaler,top)):block.type)}function buildTheme(main,spec,scopes){return new styleMod.StyleModule(spec,{finish(sel){return/&/.test(sel)?sel.replace(/&\w*/,m=>
{if("\x26"==m)return main;if(!scopes||!scopes[m])throw new RangeError(`Unsupported selector: ${m}`);return scopes[m]}):main+" "+sel}})}function findChild(cView,dom,dir){for(;dom;){var curView=ContentView.get(dom);if(curView&&curView.parent==cView)return curView;curView=dom.parentNode;dom=curView!=cView.dom?curView:0<dir?dom.nextSibling:dom.previousSibling}return null}function safariSelectionRangeHack(view){function read(event){event.preventDefault();event.stopImmediatePropagation();found=event.getTargetRanges()[0]}
let found=null;view.contentDOM.addEventListener("beforeinput",read,!0);document.execCommand("indent");view.contentDOM.removeEventListener("beforeinput",read,!0);if(!found)return null;let anchorNode=found.startContainer,anchorOffset=found.startOffset,focusNode=found.endContainer,focusOffset=found.endOffset;view=view.docView.domAtPos(view.state.selection.main.anchor);isEquivalentPosition(view.node,view.offset,focusNode,focusOffset)&&([anchorNode,anchorOffset,focusNode,focusOffset]=[focusNode,focusOffset,
anchorNode,anchorOffset]);return{anchorNode,anchorOffset,focusNode,focusOffset}}function applyDOMChange(view,start,end,typeOver){let change;var sel=view.state.selection.main,bounds;if(-1<start&&(bounds=view.docView.domBoundsAround(start,end,0))){let {from,to}=bounds;var newSel=view.docView.impreciseHead||view.docView.impreciseAnchor?[]:selectionPoints(view);start=new DOMReader(newSel,view);start.readRange(bounds.startDOM,bounds.endDOM);newSel=selectionFromPoints(newSel,from);bounds=sel.from;end=null;
if(8===view.inputState.lastKeyCode&&view.inputState.lastKeyTime>Date.now()-100||browser.android&&start.text.length<to-from)bounds=sel.to,end="end";(bounds=findDiff(view.state.sliceDoc(from,to),start.text,bounds-from,end))&&(change={from:from+bounds.from,to:from+bounds.toA,insert:view.state.toText(start.text.slice(bounds.from,bounds.toB))})}else if(view.hasFocus||!view.state.facet(editable)){bounds=view.observer.selectionRange;let {impreciseHead:iHead,impreciseAnchor:iAnchor}=view.docView;start=iHead&&
iHead.node==bounds.focusNode&&iHead.offset==bounds.focusOffset||!contains(view.contentDOM,bounds.focusNode)?view.state.selection.main.head:view.docView.posFromDOM(bounds.focusNode,bounds.focusOffset);bounds=iAnchor&&iAnchor.node==bounds.anchorNode&&iAnchor.offset==bounds.anchorOffset||!contains(view.contentDOM,bounds.anchorNode)?view.state.selection.main.anchor:view.docView.posFromDOM(bounds.anchorNode,bounds.anchorOffset);if(start!=sel.head||bounds!=sel.anchor)newSel=state$jscomp$0.EditorSelection.single(bounds,
start)}if(change||newSel)if(!change&&typeOver&&!sel.empty&&newSel&&newSel.main.empty?change={from:sel.from,to:sel.to,insert:view.state.doc.slice(sel.from,sel.to)}:change&&change.from>=sel.from&&change.to<=sel.to&&(change.from!=sel.from||change.to!=sel.to)&&4>=sel.to-sel.from-(change.to-change.from)&&(change={from:sel.from,to:sel.to,insert:view.state.doc.slice(sel.from,change.from).append(change.insert).append(view.state.doc.slice(change.to,sel.to))}),change){var startState=view.state;if(!(browser.android&&
(change.from==sel.from&&change.to==sel.to&&1==change.insert.length&&2==change.insert.lines&&dispatchKey(view.contentDOM,"Enter",13)||change.from==sel.from-1&&change.to==sel.to&&0==change.insert.length&&dispatchKey(view.contentDOM,"Backspace",8)||change.from==sel.from&&change.to==sel.to+1&&0==change.insert.length&&dispatchKey(view.contentDOM,"Delete",46))||browser.ios&&view.inputState.flushIOSKey(view))){var text=change.insert.toString();view.state.facet(inputHandler).some(h=>h(view,change.from,change.to,
text))||(0<=view.inputState.composing&&view.inputState.composing++,change.from>=sel.from&&change.to<=sel.to&&change.to-change.from>=(sel.to-sel.from)/3&&(!newSel||newSel.main.empty&&newSel.main.from==change.from+change.insert.length)?(newSel=sel.from<change.from?startState.sliceDoc(sel.from,change.from):"",sel=sel.to>change.to?startState.sliceDoc(change.to,sel.to):"",newSel=startState.replaceSelection(view.state.toText(newSel+change.insert.sliceString(0,void 0,view.state.lineBreak)+sel))):(sel=startState.changes(change),
newSel={changes:sel,selection:newSel&&!startState.selection.main.eq(newSel.main)&&newSel.main.to<=sel.newLength?startState.selection.replaceRange(newSel.main):void 0}),view.dispatch(newSel,{scrollIntoView:!0,annotations:state$jscomp$0.Transaction.userEvent.of("input")}))}}else newSel&&!newSel.main.eq(sel)&&(sel=!1,view.inputState.lastSelectionTime>Date.now()-50&&("keyboardselection"==view.inputState.lastSelectionOrigin?sel=!0:startState=state$jscomp$0.Transaction.userEvent.of(view.inputState.lastSelectionOrigin)),
view.dispatch({selection:newSel,scrollIntoView:sel,annotations:startState}))}function findDiff(a,b,preferredPos,preferredSide){var minLen=Math.min(a.length,b.length);let from=0;for(;from<minLen&&a.charCodeAt(from)==b.charCodeAt(from);)from++;if(from==minLen&&a.length==b.length)return null;minLen=a.length;let toB=b.length;for(;0<minLen&&0<toB&&a.charCodeAt(minLen-1)==b.charCodeAt(toB-1);)minLen--,toB--;"end"==preferredSide&&(preferredPos-=minLen+Math.max(0,from-Math.min(minLen,toB))-from);minLen<from&&
a.length<b.length?(from-=preferredPos<=from&&preferredPos>=minLen?from-preferredPos:0,toB=from+(toB-minLen),minLen=from):toB<from&&(from-=preferredPos<=from&&preferredPos>=toB?from-preferredPos:0,minLen=from+(minLen-toB),toB=from);return{from,toA:minLen,toB}}function isBlockElement(node){return 1==node.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(node.nodeName)}function selectionPoints(view){let result=[];if(view.root.activeElement!=view.contentDOM)return result;let {anchorNode,
anchorOffset,focusNode,focusOffset}=view.observer.selectionRange;anchorNode&&(result.push(new DOMPoint(anchorNode,anchorOffset)),focusNode==anchorNode&&focusOffset==anchorOffset||result.push(new DOMPoint(focusNode,focusOffset)));return result}function selectionFromPoints(points,base){if(0==points.length)return null;let anchor=points[0].pos;points=2==points.length?points[1].pos:anchor;return-1<anchor&&-1<points?state$jscomp$0.EditorSelection.single(anchor+base,points+base):null}function ensureTop(given,
dom){return null==given?dom.getBoundingClientRect().top:given}function ensureGlobalHandler(){window.addEventListener("resize",()=>{-1==resizeDebounce&&(resizeDebounce=setTimeout(handleResize,50))})}function handleResize(){resizeDebounce=-1;let found=document.querySelectorAll(".cm-content");for(let i=0;i<found.length;i++){let docView=ContentView.get(found[i]);docView&&docView.editorView.requestMeasure()}}function modifiers(name,event,shift){event.altKey&&(name="Alt-"+name);event.ctrlKey&&(name="Ctrl-"+
name);event.metaKey&&(name="Meta-"+name);!1!==shift&&event.shiftKey&&(name="Shift-"+name);return name}function getKeymap(state){state=state.facet(keymap);let map=Keymaps.get(state);map||Keymaps.set(state,map=buildKeymap(state.reduce((a,b)=>a.concat(b),[])));return map}function buildKeymap(bindings,platform=currentPlatform){let bound=Object.create(null),isPrefix=Object.create(null),checkPrefix=(name,is)=>{let current=isPrefix[name];if(null==current)isPrefix[name]=is;else if(current!=is)throw Error("Key binding "+
name+" is used both as a regular binding and as a multi-stroke prefix");},add=(scope,key,command,preventDefault)=>{var scopeObj=bound[scope]||(bound[scope]=Object.create(null));key=key.split(/ (?!$)/).map(k=>{k=k.split(/-(?!$)/);let result=k[k.length-1];"Space"==result&&(result=" ");let alt,ctrl,shift,meta;for(let i=0;i<k.length-1;++i){const mod=k[i];if(/^(cmd|meta|m)$/i.test(mod))meta=!0;else if(/^a(lt)?$/i.test(mod))alt=!0;else if(/^(c|ctrl|control)$/i.test(mod))ctrl=!0;else if(/^s(hift)?$/i.test(mod))shift=
!0;else if(/^mod$/i.test(mod))"mac"==platform?meta=!0:ctrl=!0;else throw Error("Unrecognized modifier name: "+mod);}alt&&(result="Alt-"+result);ctrl&&(result="Ctrl-"+result);meta&&(result="Meta-"+result);shift&&(result="Shift-"+result);return result});for(let i=1;i<key.length;i++){let prefix=key.slice(0,i).join(" ");checkPrefix(prefix,!0);scopeObj[prefix]||(scopeObj[prefix]={preventDefault:!0,commands:[view=>{let ourObj=storedPrefix={view,prefix,scope};setTimeout(()=>{storedPrefix==ourObj&&(storedPrefix=
null)},4E3);return!0}]})}key=key.join(" ");checkPrefix(key,!1);scopeObj=scopeObj[key]||(scopeObj[key]={preventDefault:!1,commands:[]});scopeObj.commands.push(command);preventDefault&&(scopeObj.preventDefault=!0)};for(let b of bindings)if(bindings=b[platform]||b.key)for(let scope of b.scope?b.scope.split(" "):["editor"])add(scope,bindings,b.run,b.preventDefault),b.shift&&add(scope,"Shift-"+bindings,b.shift,b.preventDefault);return bound}function runHandlers(map,event,view,scope){let name=w3cKeyname.keyName(event),
isChar=1==name.length&&" "!=name,prefix="",fallthrough=!1;storedPrefix&&storedPrefix.view==view&&storedPrefix.scope==scope&&(prefix=storedPrefix.prefix+" ",fallthrough=0>modifierCodes.indexOf(event.keyCode))&&(storedPrefix=null);let runFor=binding=>{if(binding){for(let cmd of binding.commands)if(cmd(view))return!0;binding.preventDefault&&(fallthrough=!0)}return!1};map=map[scope];let baseName;if(map){if(runFor(map[prefix+modifiers(name,event,!isChar)]))return!0;if(isChar&&(event.shiftKey||event.altKey||
event.metaKey)&&(baseName=w3cKeyname.base[event.keyCode])&&baseName!=name){if(runFor(map[prefix+modifiers(baseName,event,!0)]))return!0}else if(isChar&&event.shiftKey&&runFor(map[prefix+modifiers(name,event,!0)]))return!0}return fallthrough}function getBase(view){let rect=view.scrollDOM.getBoundingClientRect();return{left:(view.textDirection==exports.Direction.LTR?rect.left:rect.right-view.scrollDOM.clientWidth)-view.scrollDOM.scrollLeft,top:rect.top-view.scrollDOM.scrollTop}}function wrappedLine(view,
pos,inside){pos=state$jscomp$0.EditorSelection.cursor(pos);return{from:Math.max(inside.from,view.moveToLineBoundary(pos,!1,!0).from),to:Math.min(inside.to,view.moveToLineBoundary(pos,!0,!0).from)}}function measureRange(view,range){function piece(left,top,right,bottom){return new Piece(left-base.left,top-base.top,right-left,bottom-top,"cm-selectionBackground")}function pieces({top,bottom,horizontal}){let pieces=[];for(let i=0;i<horizontal.length;i+=2)pieces.push(piece(horizontal[i],top,horizontal[i+
1],bottom));return pieces}function drawForLine(from$jscomp$0,to$jscomp$0,line){function addSpan(from,fromOpen,to,toOpen,dir){from=view.coordsAtPos(from,from==line.to?-1:1);to=view.coordsAtPos(to,to==line.from?1:-1);top=Math.min(from.top,to.top,top);bottom=Math.max(from.bottom,to.bottom,bottom);dir==exports.Direction.LTR?horizontal.push(ltr&&fromOpen?leftSide:from.left,ltr&&toOpen?rightSide:to.right):horizontal.push(!ltr&&toOpen?leftSide:to.left,!ltr&&fromOpen?rightSide:from.right)}let top=1E9,bottom=
-1E9,horizontal=[],start=null!==from$jscomp$0&&void 0!==from$jscomp$0?from$jscomp$0:line.from,end=null!==to$jscomp$0&&void 0!==to$jscomp$0?to$jscomp$0:line.to;for(let r of view.visibleRanges)if(r.to>start&&r.from<end)for(let pos=Math.max(r.from,start),endPos=Math.min(r.to,end);;){let docLine=view.state.doc.lineAt(pos);for(let span of view.bidiSpans(docLine)){let spanFrom=span.from+docLine.from,spanTo=span.to+docLine.from;if(spanFrom>=endPos)break;spanTo>pos&&addSpan(Math.max(spanFrom,pos),null==from$jscomp$0&&
spanFrom<=start,Math.min(spanTo,endPos),null==to$jscomp$0&&spanTo>=end,span.dir)}pos=docLine.to+1;if(pos>=endPos)break}0==horizontal.length&&addSpan(start,null==from$jscomp$0,end,null==to$jscomp$0,view.textDirection);return{top,bottom,horizontal}}if(range.to<=view.viewport.from||range.from>=view.viewport.to)return[];var from$jscomp$1=Math.max(range.from,view.viewport.from),to$jscomp$1=Math.min(range.to,view.viewport.to);let ltr=view.textDirection==exports.Direction.LTR;var content=view.contentDOM,
contentRect=content.getBoundingClientRect();let base=getBase(view);content=window.getComputedStyle(content.firstChild);let leftSide=contentRect.left+parseInt(content.paddingLeft),rightSide=contentRect.right-parseInt(content.paddingRight);contentRect=view.visualLineAt(from$jscomp$1);content=view.visualLineAt(to$jscomp$1);view.lineWrapping&&(contentRect=wrappedLine(view,from$jscomp$1,contentRect),content=wrappedLine(view,to$jscomp$1,content));if(contentRect.from==content.from)return pieces(drawForLine(range.from,
range.to,contentRect));from$jscomp$1=drawForLine(range.from,null,contentRect);range=drawForLine(null,range.to,content);to$jscomp$1=[];contentRect.to<content.from-1?to$jscomp$1.push(piece(leftSide,from$jscomp$1.bottom,rightSide,range.top)):from$jscomp$1.bottom<range.top&&4>range.top-from$jscomp$1.bottom&&(from$jscomp$1.bottom=range.top=(from$jscomp$1.bottom+range.top)/2);return pieces(from$jscomp$1).concat(to$jscomp$1).concat(pieces(range))}function measureCursor(view,cursor,primary){cursor=view.coordsAtPos(cursor.head,
cursor.assoc||1);if(!cursor)return null;view=getBase(view);return new Piece(cursor.left-view.left,cursor.top-view.top,-1,cursor.bottom-cursor.top,primary?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary")}function iterMatches(doc,re,from,to,f){re.lastIndex=0;for(let cursor=doc.iterRange(from,to),pos=from,m;!cursor.next().done;pos+=cursor.value.length)if(!cursor.lineBreak)for(;m=re.exec(cursor.value);)f(pos+m.index,pos+m.index+m[0].length,m)}function specialCharPlugin(){return _plugin||
(_plugin=ViewPlugin.fromClass(class{constructor(view){this.view=view;this.decorations=Decoration.none;this.decorationCache=Object.create(null);this.decorator=this.makeDecorator(view.state.facet(specialCharConfig));this.decorations=this.decorator.createDeco(view)}makeDecorator(conf){return new MatchDecorator({regexp:conf.specialChars,decoration:(m,view,pos)=>{let {doc}=view.state;m=text$jscomp$0.codePointAt(m[0],0);return 9==m?(m=doc.lineAt(pos),view=view.state.tabSize,pos=text$jscomp$0.countColumn(doc.sliceString(m.from,
pos),0,view),Decoration.replace({widget:new TabWidget((view-pos%view)*this.view.defaultCharacterWidth)})):this.decorationCache[m]||(this.decorationCache[m]=Decoration.replace({widget:new SpecialCharWidget(conf,m)}))},boundary:conf.replaceTabs?void 0:/[^]/})}update(update){let conf=update.state.facet(specialCharConfig);update.startState.facet(specialCharConfig)!=conf?(this.decorator=this.makeDecorator(conf),this.decorations=this.decorator.createDeco(update.view)):this.decorations=this.decorator.updateDeco(update,
this.decorations)}},{decorations:v=>v.decorations}))}Object.defineProperty(exports,"__esModule",{value:!0});var state$jscomp$0=require("module$node_modules$$codemirror$state$dist$index_cjs"),styleMod=require("module$node_modules$style_mod$dist$style_mod_cjs"),rangeset=require("module$node_modules$$codemirror$rangeset$dist$index_cjs"),text$jscomp$0=require("module$node_modules$$codemirror$text$dist$index_cjs"),w3cKeyname=require("module$node_modules$w3c_keyname$index_cjs");const Rect0={left:0,right:0,
top:0,bottom:0};class DOMSelection{constructor(){this.anchorNode=null;this.anchorOffset=0;this.focusNode=null;this.focusOffset=0}eq(domSel){return this.anchorNode==domSel.anchorNode&&this.anchorOffset==domSel.anchorOffset&&this.focusNode==domSel.focusNode&&this.focusOffset==domSel.focusOffset}set(domSel){this.anchorNode=domSel.anchorNode;this.anchorOffset=domSel.anchorOffset;this.focusNode=domSel.focusNode;this.focusOffset=domSel.focusOffset}}let preventScrollSupported=null,scratchRange;class DOMPos{constructor(node,
offset,precise=!0){this.node=node;this.offset=offset;this.precise=precise}static before(dom,precise){return new DOMPos(dom.parentNode,domIndex(dom),precise)}static after(dom,precise){return new DOMPos(dom.parentNode,domIndex(dom)+1,precise)}}const none$3=[];class ContentView{constructor(){this.dom=this.parent=null;this.dirty=2}get editorView(){if(!this.parent)throw Error("Accessing view in orphan content view");return this.parent.editorView}get overrideDOMText(){return null}get posAtStart(){return this.parent?
this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(view){let pos=this.posAtStart;for(let child of this.children){if(child==view)return pos;pos+=child.length+child.breakAfter}throw new RangeError("Invalid child in posBefore");}posAfter(view){return this.posBefore(view)+view.length}coordsAt(_pos,_side){return null}sync(track){var _a;if(this.dirty&2){var parent=this.dom,pos=null;for(let child of this.children){if(child.dirty){var next=pos?pos.nextSibling:parent.firstChild;
child.dom||!next||(null===(_a=ContentView.get(next))||void 0===_a?0:_a.parent)||child.reuseDOM(next);child.sync(track);child.dirty=0}track&&track.node==parent&&pos!=child.dom&&(track.written=!0);next=parent;var dom=child.dom;pos=pos?pos.nextSibling:next.firstChild;if(dom.parentNode==next)for(;pos!=dom;)pos=rm(pos);else next.insertBefore(dom,pos);pos=child.dom}(_a=pos?pos.nextSibling:parent.firstChild)&&track&&track.node==parent&&(track.written=!0);for(;_a;)_a=rm(_a)}else if(this.dirty&1)for(parent of this.children)parent.dirty&&
(parent.sync(track),parent.dirty=0)}reuseDOM(_dom){return!1}localPosFromDOM(node,offset){if(node==this.dom)node=this.dom.childNodes[offset];else{for(offset=0==maxOffset(node)?0:0==offset?-1:1;;){let parent=node.parentNode;if(parent==this.dom)break;0==offset&&parent.firstChild!=parent.lastChild&&(offset=node==parent.firstChild?-1:1);node=parent}node=0>offset?node:node.nextSibling}if(node==this.dom.firstChild)return 0;for(;node&&!ContentView.get(node);)node=node.nextSibling;if(!node)return this.length;
for(let i=0,pos=0;;i++){offset=this.children[i];if(offset.dom==node)return pos;pos+=offset.length+offset.breakAfter}}domBoundsAround(from,to,offset=0){let fromI=-1,fromStart=-1,toI=-1,toEnd=-1;for(let i=0,pos=offset,prevEnd=offset;i<this.children.length;i++){let child=this.children[i],end=pos+child.length;if(pos<from&&end>to)return child.domBoundsAround(from,to,pos);end>=from&&-1==fromI&&(fromI=i,fromStart=pos);if(pos>to&&child.dom.parentNode==this.dom){toI=i;toEnd=prevEnd;break}prevEnd=end;pos=end+
child.breakAfter}return{from:fromStart,to:0>toEnd?offset+this.length:toEnd,startDOM:(fromI?this.children[fromI-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:toI<this.children.length&&0<=toI?this.children[toI].dom:null}}markDirty(andParent=!1){this.dirty&2||(this.dirty|=2,this.markParentsDirty(andParent))}markParentsDirty(childList){for(let parent=this.parent;parent;parent=parent.parent){childList&&(parent.dirty|=2);if(parent.dirty&1)break;parent.dirty|=1;childList=!1}}setParent(parent){this.parent!=
parent&&(this.parent=parent,this.dirty&&this.markParentsDirty(!0))}setDOM(dom){this.dom=dom;dom.cmView=this}get rootView(){for(let v=this;;){let parent=v.parent;if(!parent)return v;v=parent}}replaceChildren(from,to,children=none$3){this.markDirty();for(let i=from;i<to;i++){let child=this.children[i];child.parent==this&&(child.parent=null)}this.children.splice(from,to-from,...children);for(from=0;from<children.length;from++)children[from].setParent(this)}ignoreMutation(_rec){return!1}ignoreEvent(_event){return!1}childCursor(pos=
this.length){return new ChildCursor(this.children,pos,this.children.length)}childPos(pos,bias=1){return this.childCursor().findPos(pos,bias)}toString(){let name=this.constructor.name.replace("View","");return name+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==name?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(node){return node.cmView}}ContentView.prototype.breakAfter=0;class ChildCursor{constructor(children,pos,i){this.children=children;this.pos=
pos;this.i=i;this.off=0}findPos(pos,bias=1){for(;;){if(pos>this.pos||pos==this.pos&&(0<bias||0==this.i||this.children[this.i-1].breakAfter))return this.off=pos-this.pos,this;let next=this.children[--this.i];this.pos-=next.length+next.breakAfter}}}let [nav,doc$jscomp$0]="undefined"!=typeof navigator?[navigator,document]:[{userAgent:"",vendor:"",platform:""},{documentElement:{style:{}}}];const ie_edge=/Edge\/(\d+)/.exec(nav.userAgent),ie_upto10=/MSIE \d/.test(nav.userAgent),ie_11up=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(nav.userAgent),
ie=!!(ie_upto10||ie_11up||ie_edge),gecko=!ie&&/gecko\/(\d+)/i.test(nav.userAgent),chrome=!ie&&/Chrome\/(\d+)/.exec(nav.userAgent),webkit="webkitFontSmoothing"in doc$jscomp$0.documentElement.style,safari=!ie&&/Apple Computer/.test(nav.vendor);var browser={mac:/Mac/.test(nav.platform),ie,ie_version:ie_upto10?doc$jscomp$0.documentMode||6:ie_11up?+ie_11up[1]:ie_edge?+ie_edge[1]:0,gecko,gecko_version:gecko?+(/Firefox\/(\d+)/.exec(nav.userAgent)||[0,0])[1]:0,chrome:!!chrome,chrome_version:chrome?+chrome[1]:
0,ios:safari&&(/Mobile\/\w+/.test(nav.userAgent)||2<nav.maxTouchPoints),android:/Android\b/.test(nav.userAgent),webkit,safari,webkit_version:webkit?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:null!=doc$jscomp$0.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};const none$2=[];class InlineView extends ContentView{become(_other){return!1}getSide(){return 0}}InlineView.prototype.children=none$2;class TextView extends InlineView{constructor(text){super();this.text=
text}get length(){return this.text.length}createDOM(textDOM){this.setDOM(textDOM||document.createTextNode(this.text))}sync(track){this.dom||this.createDOM();this.dom.nodeValue!=this.text&&(track&&track.node==this.dom&&(track.written=!0),this.dom.nodeValue=this.text)}reuseDOM(dom){if(3!=dom.nodeType)return!1;this.createDOM(dom);return!0}merge(from,to,source){if(source&&(!(source instanceof TextView)||256<this.length-(to-from)+source.length))return!1;this.text=this.text.slice(0,from)+(source?source.text:
"")+this.text.slice(to);this.markDirty();return!0}slice(from){return new TextView(this.text.slice(from))}localPosFromDOM(node,offset){return node==this.dom?offset:offset?this.text.length:0}domAtPos(pos){return new DOMPos(this.dom,pos)}domBoundsAround(_from,_to,offset){return{from:offset,to:offset+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(pos,side){return textCoords(this.dom,pos,side)}}class MarkView extends InlineView{constructor(mark,children=[],length=0){super();this.mark=
mark;this.children=children;this.length=length;for(let ch of children)ch.setParent(this)}createDOM(){let dom=document.createElement(this.mark.tagName);this.mark.class&&(dom.className=this.mark.class);if(this.mark.attrs)for(let name in this.mark.attrs)dom.setAttribute(name,this.mark.attrs[name]);this.setDOM(dom)}sync(track){this.dom||this.createDOM();super.sync(track)}merge(from,to,source,openStart,openEnd){if(source&&(!(source instanceof MarkView&&source.mark.eq(this.mark))||from&&0>=openStart||to<
this.length&&0>=openEnd))return!1;mergeInlineChildren(this,from,to,source?source.children:none$2,openStart-1,openEnd-1);this.markDirty();return!0}slice(from){var JSCompiler_temp_const=this.mark,children=this.children;let result=[],off=0;for(let elt of children)children=off+elt.length,children>from&&result.push(off<from?elt.slice(from-off):elt),off=children;return new MarkView(JSCompiler_temp_const,result,this.length-from)}domAtPos(pos){return inlineDOMAtPos(this.dom,this.children,pos)}coordsAt(pos,
side){return coordsInChildren(this,pos,side)}}class WidgetView extends InlineView{constructor(widget,length,side){super();this.widget=widget;this.length=length;this.side=side}static create(widget,length,side){return new (widget.customView||WidgetView)(widget,length,side)}slice(from){return WidgetView.create(this.widget,this.length-from,this.side)}sync(){this.dom&&this.widget.updateDOM(this.dom)||(this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}getSide(){return this.side}merge(from,
to,source,openStart,openEnd){if(source&&(!(source instanceof WidgetView&&this.widget.compare(source.widget))||0<from&&0>=openStart||to<this.length&&0>=openEnd))return!1;this.length=from+(source?source.length:0)+(this.length-to);return!0}become(other){return other.length==this.length&&other instanceof WidgetView&&other.side==this.side&&this.widget.constructor==other.widget.constructor?(this.widget.eq(other.widget)||this.markDirty(!0),this.widget=other.widget,!0):!1}ignoreMutation(){return!0}ignoreEvent(event){return this.widget.ignoreEvent(event)}get overrideDOMText(){if(0==
this.length)return text$jscomp$0.Text.empty;for(var top=this;top.parent;)top=top.parent;top=(top=top.editorView)&&top.state.doc;let start=this.posAtStart;return top?top.slice(start,start+this.length):text$jscomp$0.Text.empty}domAtPos(pos){return 0==pos?DOMPos.before(this.dom):DOMPos.after(this.dom,pos==this.length)}domBoundsAround(){return null}coordsAt(pos,side){let rects=this.dom.getClientRects(),rect;if(!rects.length)return Rect0;for(let i=0<pos?rects.length-1:0;!(rect=rects[i],0<pos?0==i:i==rects.length-
1||rect.top<rect.bottom);i+=0<pos?-1:1);return 0==pos&&0<side||pos==this.length&&0>=side?rect:flattenRect(rect,0==pos)}}class CompositionView extends WidgetView{domAtPos(pos){return new DOMPos(this.widget.text,pos)}sync(){this.dom||this.setDOM(this.widget.toDOM())}localPosFromDOM(node,offset){return offset?3==node.nodeType?Math.min(offset,this.length):this.length:0}ignoreMutation(){return!1}get overrideDOMText(){return null}coordsAt(pos,side){return textCoords(this.widget.text,pos,side)}}class WidgetType{eq(_widget){return!1}updateDOM(_dom){return!1}compare(other){return this==
other||this.constructor==other.constructor&&this.eq(other)}get estimatedHeight(){return-1}ignoreEvent(_event){return!0}get customView(){return null}}exports.BlockType=void 0;(function(BlockType){BlockType[BlockType.Text=0]="Text";BlockType[BlockType.WidgetBefore=1]="WidgetBefore";BlockType[BlockType.WidgetAfter=2]="WidgetAfter";BlockType[BlockType.WidgetRange=3]="WidgetRange"})(exports.BlockType||(exports.BlockType={}));class Decoration extends rangeset.RangeValue{constructor(startSide,endSide,widget,
spec){super();this.startSide=startSide;this.endSide=endSide;this.widget=widget;this.spec=spec}get heightRelevant(){return!1}static mark(spec){return new MarkDecoration(spec)}static widget(spec){let side=spec.side||0;spec.block&&(side+=(2E8+1)*(0<side?1:-1));return new PointDecoration(spec,side,side,!!spec.block,spec.widget||null,!1)}static replace(spec){let block=!!spec.block,{start,end}=getInclusive(spec);return new PointDecoration(spec,block?-2E8*(start?2:1):1E8*(start?-1:1),block?2E8*(end?2:1):
1E8*(end?1:-1),block,spec.widget||null,!0)}static line(spec){return new LineDecoration(spec)}static set(of,sort=!1){return rangeset.RangeSet.of(of,sort)}hasHeight(){return this.widget?-1<this.widget.estimatedHeight:!1}}Decoration.none=rangeset.RangeSet.empty;class MarkDecoration extends Decoration{constructor(spec){let {start,end}=getInclusive(spec);super(1E8*(start?-1:1),1E8*(end?1:-1),null,spec);this.tagName=spec.tagName||"span";this.class=spec.class||"";this.attrs=spec.attributes||null}eq(other){return this==
other||other instanceof MarkDecoration&&this.tagName==other.tagName&&this.class==other.class&&attrsEq(this.attrs,other.attrs)}range(from,to=from){if(from>=to)throw new RangeError("Mark decorations may not be empty");return super.range(from,to)}}MarkDecoration.prototype.point=!1;class LineDecoration extends Decoration{constructor(spec){super(-1E8,-1E8,null,spec)}eq(other){return other instanceof LineDecoration&&attrsEq(this.spec.attributes,other.spec.attributes)}range(from,to=from){if(to!=from)throw new RangeError("Line decoration ranges must be zero-length");
return super.range(from,to)}}LineDecoration.prototype.mapMode=state$jscomp$0.MapMode.TrackBefore;LineDecoration.prototype.point=!0;class PointDecoration extends Decoration{constructor(spec,startSide,endSide,block,widget,isReplace){super(startSide,endSide,widget,spec);this.block=block;this.isReplace=isReplace;this.mapMode=block?0>startSide?state$jscomp$0.MapMode.TrackBefore:state$jscomp$0.MapMode.TrackAfter:state$jscomp$0.MapMode.TrackDel}get type(){return this.startSide<this.endSide?exports.BlockType.WidgetRange:
0>this.startSide?exports.BlockType.WidgetBefore:exports.BlockType.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&5<=this.widget.estimatedHeight}eq(other){var JSCompiler_temp;if(JSCompiler_temp=other instanceof PointDecoration){JSCompiler_temp=this.widget;var b=other.widget;JSCompiler_temp=JSCompiler_temp==b||!!(JSCompiler_temp&&b&&JSCompiler_temp.compare(b))}return JSCompiler_temp&&this.block==other.block&&this.startSide==other.startSide&&this.endSide==other.endSide}range(from,
to=from){if(this.isReplace&&(from>to||from==to&&0<this.startSide&&0>this.endSide))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&to!=from)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(from,to)}}PointDecoration.prototype.point=!0;class LineView extends ContentView{constructor(){super(...arguments);this.children=[];this.length=0;this.prevAttrs=void 0;this.attrs=null;this.breakAfter=0}merge(from,to,source,takeDeco,
openStart,openEnd){if(source){if(!(source instanceof LineView))return!1;this.dom||source.transferDOM(this)}takeDeco&&this.setDeco(source?source.attrs:null);mergeInlineChildren(this,from,to,source?source.children:none$1,openStart,openEnd);return!0}split(at){let end=new LineView;end.breakAfter=this.breakAfter;if(0==this.length)return end;let {i,off}=this.childPos(at);off&&(end.append(this.children[i].slice(off),0),this.children[i].merge(off,this.children[i].length,null,0,0),i++);for(let j=i;j<this.children.length;j++)end.append(this.children[j],
0);for(;0<i&&0==this.children[i-1].length;)this.children[i-1].parent=null,i--;this.children.length=i;this.markDirty();this.length=at;return end}transferDOM(other){this.dom&&(other.setDOM(this.dom),other.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(attrs){attrsEq(this.attrs,attrs)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=attrs)}append(child,openStart){joinInlineInto(this,child,openStart)}addLineDeco(deco){if(deco=
deco.spec.attributes)this.attrs=combineAttrs(deco,this.attrs||{})}domAtPos(pos){return inlineDOMAtPos(this.dom,this.children,pos)}sync(track){this.dom||(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0);void 0!==this.prevAttrs&&(updateAttrs(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0);super.sync(track);track=this.dom.lastChild;if(!track||"BR"!=track.nodeName&&ContentView.get(track)instanceof
WidgetView&&(!browser.ios||!this.children.some(ch=>ch instanceof TextView)))track=document.createElement("BR"),track.cmIgnore=!0,this.dom.appendChild(track)}measureTextSize(){if(0==this.children.length||20<this.length)return null;let totalWidth=0;for(let child of this.children){if(!(child instanceof TextView))return null;let rects=clientRectsFor(child.dom);if(1!=rects.length)return null;totalWidth+=rects[0].width}return{lineHeight:this.dom.getBoundingClientRect().height,charWidth:totalWidth/this.length}}coordsAt(pos,
side){return coordsInChildren(this,pos,side)}match(_other){return!1}get type(){return exports.BlockType.Text}static find(docView,pos){for(let i=0,off=0;;i++){let block=docView.children[i],end=off+block.length;if(end>=pos){if(block instanceof LineView)return block;if(block.length)return null}off=end+block.breakAfter}}}const none$1=[];class BlockWidgetView extends ContentView{constructor(widget,length,type){super();this.widget=widget;this.length=length;this.type=type;this.breakAfter=0}merge(from,to,
source,_takeDeco,openStart,openEnd){if(source&&(!(source instanceof BlockWidgetView&&this.widget.compare(source.widget))||0<from&&0>=openStart||to<this.length&&0>=openEnd))return!1;this.length=from+(source?source.length:0)+(this.length-to);return!0}domAtPos(pos){return 0==pos?DOMPos.before(this.dom):DOMPos.after(this.dom,pos==this.length)}split(at){let len=this.length-at;this.length=at;return new BlockWidgetView(this.widget,len,this.type)}get children(){return none$1}sync(){this.dom&&this.widget.updateDOM(this.dom)||
(this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):state$jscomp$0.Text.empty}domBoundsAround(){return null}match(other){return other instanceof BlockWidgetView&&other.type==this.type&&other.widget.constructor==this.widget.constructor?(other.widget.eq(this.widget)||this.markDirty(!0),this.widget=other.widget,this.length=other.length,this.breakAfter=other.breakAfter,
!0):!1}ignoreMutation(){return!0}ignoreEvent(event){return this.widget.ignoreEvent(event)}}class ContentBuilder{constructor(doc,pos,end){this.doc=doc;this.pos=pos;this.end=end;this.content=[];this.curLine=null;this.breakAtStart=0;this.openEnd=this.openStart=-1;this.text="";this.textOff=0;this.cursor=doc.iter();this.skip=pos}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let last=this.content[this.content.length-1];return!last.breakAfter&&
!(last instanceof BlockWidgetView&&last.type==exports.BlockType.WidgetBefore)}getLine(){this.curLine||this.content.push(this.curLine=new LineView);return this.curLine}addWidget(view){this.curLine=null;this.content.push(view)}finish(){this.posCovered()||this.getLine()}wrapMarks(view,active){for(let i=active.length-1;0<=i;i--)view=new MarkView(active[i],[view],view.length);return view}buildText(length,active,openStart){for(;0<length;){if(this.textOff==this.text.length){let {value,lineBreak,done}=this.cursor.next(this.skip);
this.skip=0;if(done)throw Error("Ran out of text content when drawing inline views");if(lineBreak){this.posCovered()||this.getLine();this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1;this.curLine=null;length--;continue}else this.text=value,this.textOff=0}let take=Math.min(this.text.length-this.textOff,length,512);this.getLine().append(this.wrapMarks(new TextView(this.text.slice(this.textOff,this.textOff+take)),active),openStart);this.textOff+=take;length-=take;
openStart=0}}span(from,to,active,openStart){this.buildText(to-from,active,openStart);this.pos=to;0>this.openStart&&(this.openStart=openStart)}point(from,to,deco,active,openStart){from=to-from;deco instanceof PointDecoration?deco.block?({type:active}=deco,active!=exports.BlockType.WidgetAfter||this.posCovered()||this.getLine(),this.addWidget(new BlockWidgetView(deco.widget||new NullWidget("div"),from,active))):(deco=this.wrapMarks(WidgetView.create(deco.widget||new NullWidget("span"),from,deco.startSide),
active),this.getLine().append(deco,openStart)):this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(deco);from&&(this.textOff+from<=this.text.length?this.textOff+=from:(this.skip+=from-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=to);0>this.openStart&&(this.openStart=openStart)}static build(text,from,to,decorations){text=new ContentBuilder(text,from,to);text.openEnd=rangeset.RangeSet.spans(decorations,from,to,text);0>text.openStart&&(text.openStart=text.openEnd);
text.finish();return text}}class NullWidget extends WidgetType{constructor(tag){super();this.tag=tag}eq(other){return other.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(elt){return elt.nodeName.toLowerCase()==this.tag}}const none=[],clickAddsSelectionRange=state$jscomp$0.Facet.define(),dragMovesSelection$1=state$jscomp$0.Facet.define(),mouseSelectionStyle=state$jscomp$0.Facet.define(),exceptionSink=state$jscomp$0.Facet.define(),updateListener=state$jscomp$0.Facet.define(),
inputHandler=state$jscomp$0.Facet.define(),editable=state$jscomp$0.Facet.define({combine:values=>values.length?values[0]:!0});class PluginFieldProvider{constructor(field,get){this.field=field;this.get=get}}class PluginField{from(get){return new PluginFieldProvider(this,get)}static define(){return new PluginField}}PluginField.decorations=PluginField.define();PluginField.scrollMargins=PluginField.define();let nextPluginID=0;const viewPlugin=state$jscomp$0.Facet.define();class ViewPlugin{constructor(id,
create,fields){this.id=id;this.create=create;this.fields=fields;this.extension=viewPlugin.of(this)}static define(create,spec){let {eventHandlers,provide,decorations}=spec||{};spec=[];if(provide)for(let provider of Array.isArray(provide)?provide:[provide])spec.push(provider);eventHandlers&&spec.push(domEventHandlers.from(value=>({plugin:value,handlers:eventHandlers})));decorations&&spec.push(PluginField.decorations.from(decorations));return new ViewPlugin(nextPluginID++,create,spec)}static fromClass(cls,
spec){return ViewPlugin.define(view=>new cls(view),spec)}}const domEventHandlers=PluginField.define();class PluginInstance{constructor(spec){this.spec=spec;this.value=this.mustUpdate=null}takeField(type,target){for(let {field,get}of this.spec.fields)field==type&&target.push(get(this.value))}update(view){if(!this.value)try{this.value=this.spec.create(view)}catch(e){return logException(view.state,e,"CodeMirror plugin crashed"),PluginInstance.dummy}else if(this.mustUpdate){view=this.mustUpdate;this.mustUpdate=
null;if(!this.value.update)return this;try{this.value.update(view)}catch(e){logException(view.state,e,"CodeMirror plugin crashed");if(this.value.destroy)try{this.value.destroy()}catch(_){}return PluginInstance.dummy}}return this}destroy(view){var _a;if(null===(_a=this.value)||void 0===_a?0:_a.destroy)try{this.value.destroy()}catch(e){logException(view.state,e,"CodeMirror plugin crashed")}}}PluginInstance.dummy=new PluginInstance(ViewPlugin.define(()=>({})));const editorAttributes=state$jscomp$0.Facet.define({combine:values=>
values.reduce((a,b)=>combineAttrs(b,a),{})}),contentAttributes=state$jscomp$0.Facet.define({combine:values=>values.reduce((a,b)=>combineAttrs(b,a),{})}),decorations=state$jscomp$0.Facet.define(),styleModule=state$jscomp$0.Facet.define();class ChangedRange{constructor(fromA,toA,fromB,toB){this.fromA=fromA;this.toA=toA;this.fromB=fromB;this.toB=toB}join(other){return new ChangedRange(Math.min(this.fromA,other.fromA),Math.max(this.toA,other.toA),Math.min(this.fromB,other.fromB),Math.max(this.toB,other.toB))}addToSet(set){let i=
set.length,me=this;for(;0<i;i--){let range=set[i-1];if(!(range.fromA>me.toA)){if(range.toA<me.fromA)break;me=me.join(range);set.splice(i-1,1)}}set.splice(i,0,me);return set}static extendWithRanges(diff,ranges){if(0==ranges.length)return diff;let result=[];for(let dI=0,rI=0,posA=0,posB=0;;dI++){let next=dI==diff.length?null:diff[dI],off=posA-posB,end=next?next.fromB:1E9;for(;rI<ranges.length&&ranges[rI]<end;){let to=ranges[rI+1],fromB=Math.max(posB,ranges[rI]),toB=Math.min(end,to);fromB<=toB&&(new ChangedRange(fromB+
off,toB+off,fromB,toB)).addToSet(result);if(to>end)break;else rI+=2}if(!next)return result;(new ChangedRange(next.fromA,next.toA,next.fromB,next.toB)).addToSet(result);posA=next.toA;posB=next.toB}}}class ViewUpdate{constructor(view,state$1,transactions=none){this.view=view;this.state=state$1;this.transactions=transactions;this.flags=0;this.startState=view.state;this.changes=state$jscomp$0.ChangeSet.empty(this.startState.doc.length);for(let tr of transactions)this.changes=this.changes.compose(tr.changes);
let changedRanges=[];this.changes.iterChangedRanges((fromA,toA,fromB,toB)=>changedRanges.push(new ChangedRange(fromA,toA,fromB,toB)));this.changedRanges=changedRanges;state$1=view.hasFocus;state$1!=view.inputState.notifiedFocused&&(view.inputState.notifiedFocused=state$1,this.flags|=1);this.docChanged&&(this.flags|=2)}get viewportChanged(){return 0<(this.flags&4)}get heightChanged(){return 0<(this.flags&2)}get geometryChanged(){return this.docChanged||0<(this.flags&18)}get focusChanged(){return 0<
(this.flags&1)}get docChanged(){return this.transactions.some(tr=>tr.docChanged)}get selectionSet(){return this.transactions.some(tr=>tr.selection)}get empty(){return 0==this.flags&&0==this.transactions.length}}class DocView extends ContentView{constructor(view){super();this.view=view;this.compositionDeco=Decoration.none;this.decorations=[];this.minWidthTo=this.minWidthFrom=this.minWidth=0;this.impreciseHead=this.impreciseAnchor=null;this.setDOM(view.contentDOM);this.children=[new LineView];this.children[0].setParent(this);
this.updateInner([new ChangedRange(0,0,0,view.state.doc.length)],this.updateDeco(),0)}get root(){return this.view.root}get editorView(){return this.view}get length(){return this.view.state.doc.length}update(update){let changedRanges=update.changedRanges;0<this.minWidth&&changedRanges.length&&(changedRanges.every(({fromA,toA})=>toA<this.minWidthFrom||fromA>this.minWidthTo)?(this.minWidthFrom=update.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=update.changes.mapPos(this.minWidthTo,1)):this.minWidth=
0);0>this.view.inputState.composing?this.compositionDeco=Decoration.none:update.transactions.length&&(this.compositionDeco=computeCompositionDeco(this.view,update.changes));let forceSelection=(browser.ie||browser.chrome)&&!this.compositionDeco.size&&update&&update.state.doc.lines!=update.startState.doc.lines;var prevDeco=this.decorations;let deco=this.updateDeco();prevDeco=findChangedDeco(prevDeco,deco,update.changes);changedRanges=ChangedRange.extendWithRanges(changedRanges,prevDeco);prevDeco=update.transactions.some(tr=>
"pointerselection"==tr.annotation(state$jscomp$0.Transaction.userEvent));if(0==this.dirty&&0==changedRanges.length&&!(update.flags&12)&&update.state.selection.main.from>=this.view.viewport.from&&update.state.selection.main.to<=this.view.viewport.to)return this.updateSelection(forceSelection,prevDeco),!1;this.updateInner(changedRanges,deco,update.startState.doc.length,forceSelection,prevDeco);return!0}updateInner(changes,deco,oldLength,forceSelection=!1,pointerSel=!1){this.updateChildren(changes,deco,
oldLength);let {observer}=this.view;observer.ignore(()=>{this.dom.style.height=this.view.viewState.domHeight+"px";this.dom.style.minWidth=this.minWidth?this.minWidth+"px":"";let track=browser.chrome||browser.ios?{node:observer.selectionRange.focusNode,written:!1}:void 0;this.sync(track);this.dirty=0;track&&(track.written||observer.selectionRange.focusNode!=track.node)&&(forceSelection=!0);this.updateSelection(forceSelection,pointerSel);this.dom.style.height=""})}updateChildren(changes,deco,oldLength){oldLength=
this.childCursor(oldLength);for(let i=changes.length-1;;i--){let next=0<=i?changes[i]:null;if(!next)break;let {fromA,toA,fromB,toB}=next,{content,breakAtStart,openStart,openEnd}=ContentBuilder.build(this.view.state.doc,fromB,toB,deco),{i:toI,off:toOff}=oldLength.findPos(toA,1),{i:fromI,off:fromOff}=oldLength.findPos(fromA,-1);this.replaceRange(fromI,fromOff,toI,toOff,content,breakAtStart,openStart,openEnd)}}replaceRange(fromI,fromOff,toI,toOff,content,breakAtStart,openStart,openEnd){let before=this.children[fromI],
last=content.length?content[content.length-1]:null,breakAtEnd=last?last.breakAfter:breakAtStart;if(fromI!=toI||breakAtStart||breakAtEnd||!(2>content.length)||!before.merge(fromOff,toOff,content.length?last:null,0==fromOff,openStart,openEnd)){var after=this.children[toI];toOff<after.length||after.children.length&&0==after.children[after.children.length-1].length?(fromI==toI&&(after=after.split(toOff),toOff=0),!breakAtEnd&&last&&after.merge(0,toOff,last,!0,0,openEnd)?content[content.length-1]=after:
((toOff||after.children.length&&0==after.children[0].length)&&after.merge(0,toOff,null,!1,0,openEnd),content.push(after))):after.breakAfter&&(last?last.breakAfter=1:breakAtStart=1);toI++;before.breakAfter=breakAtStart;0<fromOff&&(!breakAtStart&&content.length&&before.merge(fromOff,before.length,content[0],!1,openStart,0)?before.breakAfter=content.shift().breakAfter:(fromOff<before.length||before.children.length&&0==before.children[before.children.length-1].length)&&before.merge(fromOff,before.length,
null,!1,openStart,0),fromI++);for(;fromI<toI&&content.length;)if(this.children[toI-1].match(content[content.length-1]))toI--,content.pop();else if(this.children[fromI].match(content[0]))fromI++,content.shift();else break;(fromI<toI||content.length)&&this.replaceChildren(fromI,toI,content)}}updateSelection(force=!1,fromPointer=!1){if(fromPointer||this.mayControlSelection()){var main=this.view.state.selection.main,anchor=this.domAtPos(main.anchor),head=main.empty?anchor:this.domAtPos(main.head);if(browser.gecko&&
main.empty&&1==anchor.node.nodeType&&anchor.node.firstChild&&(0==anchor.offset||"false"==anchor.node.childNodes[anchor.offset-1].contentEditable)&&(anchor.offset<anchor.node.childNodes.length||"false"==anchor.node.childNodes[anchor.offset].contentEditable)){let dummy=document.createTextNode("");this.view.observer.ignore(()=>anchor.node.insertBefore(dummy,anchor.node.childNodes[anchor.offset]||null));anchor=head=new DOMPos(dummy,0);force=!0}var domSel=this.view.observer.selectionRange;if(force||!domSel.focusNode||
browser.gecko&&main.empty&&nextToUneditable(domSel.focusNode,domSel.focusOffset)||!isEquivalentPosition(anchor.node,anchor.offset,domSel.anchorNode,domSel.anchorOffset)||!isEquivalentPosition(head.node,head.offset,domSel.focusNode,domSel.focusOffset))this.view.observer.ignore(()=>{let rawSel=getSelection(this.root);if(main.empty){if(browser.gecko){var nextTo=nextToUneditable(anchor.node,anchor.offset);if(nextTo&&3!=nextTo){let text=nearbyTextNode(anchor.node,anchor.offset,1==nextTo?1:-1);text&&(anchor=
new DOMPos(text,1==nextTo?0:text.nodeValue.length))}}rawSel.collapse(anchor.node,anchor.offset);null!=main.bidiLevel&&null!=domSel.cursorBidiLevel&&(domSel.cursorBidiLevel=main.bidiLevel)}else rawSel.extend?(rawSel.collapse(anchor.node,anchor.offset),rawSel.extend(head.node,head.offset)):(nextTo=document.createRange(),main.anchor>main.head&&([anchor,head]=[head,anchor]),nextTo.setEnd(head.node,head.offset),nextTo.setStart(anchor.node,anchor.offset),rawSel.removeAllRanges(),rawSel.addRange(nextTo))}),
this.view.observer.setSelectionRange(anchor,head);this.impreciseAnchor=anchor.precise?null:new DOMPos(domSel.anchorNode,domSel.anchorOffset);this.impreciseHead=head.precise?null:new DOMPos(domSel.focusNode,domSel.focusOffset)}}enforceCursorAssoc(){let cursor=this.view.state.selection.main,sel=getSelection(this.root);if(cursor.empty&&cursor.assoc&&sel.modify){var line=LineView.find(this,cursor.head);if(line){var lineStart=line.posAtStart;cursor.head!=lineStart&&cursor.head!=lineStart+line.length&&
(line=this.coordsAt(cursor.head,-1),lineStart=this.coordsAt(cursor.head,1),!line||!lineStart||line.bottom>lineStart.top||(line=this.domAtPos(cursor.head+cursor.assoc),sel.collapse(line.node,line.offset),sel.modify("move",0>cursor.assoc?"forward":"backward","lineboundary")))}}}mayControlSelection(){return this.view.state.facet(editable)?this.root.activeElement==this.dom:hasSelection(this.dom,this.view.observer.selectionRange)}nearest(dom){for(;dom;){let domView=ContentView.get(dom);if(domView&&domView.rootView==
this)return domView;dom=dom.parentNode}return null}posFromDOM(node,offset){let view=this.nearest(node);if(!view)throw new RangeError("Trying to find position for a DOM position outside of the document");return view.localPosFromDOM(node,offset)+view.posAtStart}domAtPos(pos){let {i,off}=this.childCursor().findPos(pos,-1);for(;i<this.children.length-1;){pos=this.children[i];if(off<pos.length||pos instanceof LineView)break;i++;off=0}return this.children[i].domAtPos(off)}coordsAt(pos,side){for(let off=
this.length,i=this.children.length-1;;i--){let child=this.children[i],start=off-child.breakAfter-child.length;if(pos>start||pos==start&&(child.type==exports.BlockType.Text||!i||this.children[i-1].breakAfter))return child.coordsAt(pos-start,side);off=start}}measureVisibleLineHeights(){let result=[],{from,to}=this.view.viewState.viewport,minWidth=Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1;for(let pos=0,i=0;i<this.children.length;i++){let child=this.children[i],end=pos+child.length;if(end>
to)break;if(pos>=from){result.push(child.dom.getBoundingClientRect().height);let width=child.dom.scrollWidth;width>minWidth&&(this.minWidth=minWidth=width,this.minWidthFrom=pos,this.minWidthTo=end)}pos=end+child.breakAfter}return result}measureTextSize(){for(let child of this.children)if(child instanceof LineView){let measure=child.measureTextSize();if(measure)return measure}let dummy=document.createElement("div"),lineHeight,charWidth;dummy.className="cm-line";dummy.textContent="abc def ghi jkl mno pqr stu";
this.view.observer.ignore(()=>{this.dom.appendChild(dummy);let rect=clientRectsFor(dummy.firstChild)[0];lineHeight=dummy.getBoundingClientRect().height;charWidth=rect?rect.width/27:7;dummy.remove()});return{lineHeight,charWidth}}childCursor(pos=this.length){let i=this.children.length;i&&(pos-=this.children[--i].length);return new ChildCursor(this.children,pos,i)}computeBlockGapDeco(){let deco=[],vs=this.view.viewState;for(let pos=0,i=0;;i++){let next=i==vs.viewports.length?null:vs.viewports[i],end=
next?next.from-1:this.length;if(end>pos){let height=vs.lineAt(end,0).bottom-vs.lineAt(pos,0).top;deco.push(Decoration.replace({widget:new BlockGapWidget(height),block:!0,inclusive:!0}).range(pos,end))}if(!next)break;pos=next.to+1}return Decoration.set(deco)}updateDeco(){return this.decorations=[this.computeBlockGapDeco(),this.view.viewState.lineGapDeco,this.compositionDeco,...this.view.state.facet(decorations),...this.view.pluginField(PluginField.decorations)]}scrollPosIntoView(pos,side){if(pos=this.coordsAt(pos,
side)){var mLeft=0,mRight=0,mTop=0,mBottom=0;for(var margins of this.view.pluginField(PluginField.scrollMargins))if(margins){let {left,right,top,bottom}=margins;null!=left&&(mLeft=Math.max(mLeft,left));null!=right&&(mRight=Math.max(mRight,right));null!=top&&(mTop=Math.max(mTop,top));null!=bottom&&(mBottom=Math.max(mBottom,bottom))}side=this.dom;margins={left:pos.left-mLeft,top:pos.top-mTop,right:pos.right+mRight,bottom:pos.bottom+mBottom};pos=side.ownerDocument.defaultView;for(side=side.parentNode;side;)if(1==
side.nodeType){if(mLeft=side==document.body){mBottom=0;var JSCompiler_object_inline_right_2050=pos.innerWidth;var JSCompiler_object_inline_top_2051=0;var JSCompiler_object_inline_bottom_2052=pos.innerHeight}else{if(side.scrollHeight<=side.clientHeight&&side.scrollWidth<=side.clientWidth){side=side.parentNode;continue}mRight=side.getBoundingClientRect();mBottom=mRight.left;JSCompiler_object_inline_right_2050=mRight.left+side.clientWidth;JSCompiler_object_inline_top_2051=mRight.top;JSCompiler_object_inline_bottom_2052=
mRight.top+side.clientHeight}mTop=mRight=0;margins.top<JSCompiler_object_inline_top_2051?mTop=-(JSCompiler_object_inline_top_2051-margins.top+5):margins.bottom>JSCompiler_object_inline_bottom_2052&&(mTop=margins.bottom-JSCompiler_object_inline_bottom_2052+5);margins.left<mBottom?mRight=-(mBottom-margins.left+5):margins.right>JSCompiler_object_inline_right_2050&&(mRight=margins.right-JSCompiler_object_inline_right_2050+5);if(mRight||mTop)mLeft?pos.scrollBy(mRight,mTop):(mTop&&(mBottom=side.scrollTop,
side.scrollTop+=mTop,mTop=side.scrollTop-mBottom),mRight&&(mBottom=side.scrollLeft,side.scrollLeft+=mRight,mRight=side.scrollLeft-mBottom),margins={left:margins.left-mRight,top:margins.top-mTop,right:margins.right-mRight,bottom:margins.bottom-mTop});if(mLeft)break;side=side.assignedSlot||side.parentNode}else if(11==side.nodeType)side=side.host;else break}}}class BlockGapWidget extends WidgetType{constructor(height){super();this.height=height}toDOM(){let elt=document.createElement("div");this.updateDOM(elt);
return elt}eq(other){return other.height==this.height}updateDOM(elt){elt.style.height=this.height+"px";return!0}get estimatedHeight(){return this.height}}class CompositionWidget extends WidgetType{constructor(top,text){super();this.top=top;this.text=text}eq(other){return this.top==other.top&&this.text==other.text}toDOM(){return this.top}ignoreEvent(){return!1}get customView(){return CompositionView}}class DecorationComparator$1{constructor(){this.changes=[]}compareRange(from,to){addRange(from,to,
this.changes)}comparePoint(from,to){addRange(from,to,this.changes)}}exports.Direction=void 0;(function(Direction){Direction[Direction.LTR=0]="LTR";Direction[Direction.RTL=1]="RTL"})(exports.Direction||(exports.Direction={}));const LTR=exports.Direction.LTR,RTL=exports.Direction.RTL,LowTypes=dec("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),
ArabicTypes=dec("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Brackets=Object.create(null),BracketStack=[];for(let p of["()","[]","{}"]){let l=p.charCodeAt(0),r=p.charCodeAt(1);Brackets[l]=r;Brackets[r]=-l}const BidiRE=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;class BidiSpan{constructor(from,
to,level){this.from=from;this.to=to;this.level=level}get dir(){return this.level%2?RTL:LTR}side(end,dir){return this.dir==dir==end?this.to:this.from}static find(order,index,level,assoc){let maybe=-1;for(let i=0;i<order.length;i++){let span=order[i];if(span.from<=index&&span.to>=index){if(span.level==level)return i;if(0>maybe||(0!=assoc?0>assoc?span.from<index:span.to>index:order[maybe].level>span.level))maybe=i}}if(0>maybe)throw new RangeError("Index out of range");return maybe}}const types=[];let movedOver=
"";class InputState{constructor(view){this.lastKeyTime=this.lastKeyCode=0;this.lastSelectionOrigin=this.pendingIOSKey=null;this.lastContextMenu=this.lastEscPress=this.lastSelectionTime=0;this.scrollHandlers=[];this.registeredEvents=[];this.customHandlers=[];this.composing=-1;this.compositionEndedAt=0;this.mouseSelection=null;for(let type in handlers){let handler=handlers[type];view.contentDOM.addEventListener(type,event=>{"keydown"==type&&this.keydown(view,event)||!eventBelongsToEditor(view,event)||
this.ignoreDuringComposition(event)||(this.mustFlushObserver(event)&&view.observer.forceFlush(),this.runCustomHandlers(type,view,event)?event.preventDefault():handler(view,event))});this.registeredEvents.push(type)}this.notifiedFocused=view.hasFocus;this.ensureHandlers(view);browser.safari&&view.contentDOM.addEventListener("input",()=>null)}setSelectionOrigin(origin){this.lastSelectionOrigin=origin;this.lastSelectionTime=Date.now()}ensureHandlers(view){let handlers=this.customHandlers=view.pluginField(domEventHandlers);
for(let set of handlers)for(let type in set.handlers)0>this.registeredEvents.indexOf(type)&&"scroll"!=type&&(this.registeredEvents.push(type),view.contentDOM.addEventListener(type,event=>{eventBelongsToEditor(view,event)&&this.runCustomHandlers(type,view,event)&&event.preventDefault()}))}runCustomHandlers(type,view,event){for(let set of this.customHandlers){let handler=set.handlers[type],handled=!1;if(handler){try{handled=handler.call(set.plugin,event,view)}catch(e){logException(view.state,e)}if(handled||
event.defaultPrevented)return browser.android&&"keydown"==type&&13==event.keyCode&&view.observer.flushSoon(),!0}}return!1}runScrollHandlers(view,event){for(let set of this.customHandlers){let handler=set.handlers.scroll;if(handler)try{handler.call(set.plugin,event,view)}catch(e){logException(view.state,e)}}}keydown(view,event){this.lastKeyCode=event.keyCode;this.lastKeyTime=Date.now();return this.screenKeyEvent(view,event)?!0:!browser.ios||13!=event.keyCode&&8!=event.keyCode||event.ctrlKey||event.altKey||
event.metaKey||event.synthetic?!1:(this.pendingIOSKey=13==event.keyCode?"enter":"backspace",setTimeout(()=>this.flushIOSKey(view),250),!0)}flushIOSKey(view){if(!this.pendingIOSKey)return!1;view=view.contentDOM;let key=this.pendingIOSKey;this.pendingIOSKey=null;return"enter"==key?dispatchKey(view,"Enter",13):dispatchKey(view,"Backspace",8)}ignoreDuringComposition(event){return/^key/.test(event.type)?0<this.composing?!0:browser.safari&&500>Date.now()-this.compositionEndedAt?(this.compositionEndedAt=
0,!0):!1:!1}screenKeyEvent(view,event){view=9==event.keyCode&&Date.now()<this.lastEscPress+2E3;27==event.keyCode?this.lastEscPress=Date.now():0>modifierCodes.indexOf(event.keyCode)&&(this.lastEscPress=0);return view}mustFlushObserver(event){return"keydown"==event.type&&229!=event.keyCode||"compositionend"==event.type&&!browser.ios}startMouseSelection(view,event,style){this.mouseSelection&&this.mouseSelection.destroy();this.mouseSelection=new MouseSelection(this,view,event,style)}update(update){this.mouseSelection&&
this.mouseSelection.update(update);this.lastKeyCode=this.lastSelectionTime=0}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}const modifierCodes=[16,17,18,20,91,92,224,225];class MouseSelection{constructor(inputState,view,startEvent,style){this.inputState=inputState;this.view=view;this.startEvent=startEvent;this.style=style;inputState=view.contentDOM.ownerDocument;inputState.addEventListener("mousemove",this.move=this.move.bind(this));inputState.addEventListener("mouseup",this.up=this.up.bind(this));
this.extend=startEvent.shiftKey;if(inputState=view.state.facet(state$jscomp$0.EditorState.allowMultipleSelections))inputState=view.state.facet(clickAddsSelectionRange),inputState=inputState.length?inputState[0](startEvent):browser.mac?startEvent.metaKey:startEvent.ctrlKey;this.multiple=inputState;inputState=view.state.facet(dragMovesSelection$1);this.dragMove=inputState.length?inputState[0](startEvent):browser.mac?!startEvent.altKey:!startEvent.ctrlKey;this.dragging=isInPrimarySelection(view,startEvent)?
null:!1;!1===this.dragging&&(startEvent.preventDefault(),this.select(startEvent))}move(event){if(0==event.buttons)return this.destroy();!1===this.dragging&&this.select(event)}up(event){null==this.dragging&&this.select(this.startEvent);this.dragging||event.preventDefault();this.destroy()}destroy(){let doc=this.view.contentDOM.ownerDocument;doc.removeEventListener("mousemove",this.move);doc.removeEventListener("mouseup",this.up);this.inputState.mouseSelection=null}select(event){event=this.style.get(event,
this.extend,this.multiple);event.eq(this.view.state.selection)&&event.main.assoc==this.view.state.selection.main.assoc||this.view.dispatch({selection:event,annotations:state$jscomp$0.Transaction.userEvent.of("pointerselection"),scrollIntoView:!0})}update(update){update.docChanged&&this.dragging&&(this.dragging=this.dragging.map(update.changes));this.style.update(update)}}const handlers=Object.create(null),brokenClipboardAPI=browser.ie&&15>browser.ie_version||browser.ios&&604>browser.webkit_version;
handlers.keydown=(view,event)=>{view.inputState.setSelectionOrigin("keyboardselection")};let lastTouch=0;handlers.touchstart=(view,e)=>{lastTouch=Date.now();view.inputState.setSelectionOrigin("pointerselection")};handlers.touchmove=view=>{view.inputState.setSelectionOrigin("pointerselection")};handlers.mousedown=(view,event)=>{view.observer.flush();if(!(lastTouch>Date.now()-2E3)){var style=null;for(let makeStyle of view.state.facet(mouseSelectionStyle))if(style=makeStyle(view,event))break;style||
0!=event.button||(style=basicMouseSelection(view,event));style&&(view.root.activeElement!=view.contentDOM&&view.observer.ignore(()=>focusPreventScroll(view.contentDOM)),view.inputState.startMouseSelection(view,event,style))}};const BadMouseDetail=browser.ie&&11>=browser.ie_version;let lastMouseDown=null,lastMouseDownCount=0,lastMouseDownTime=0;handlers.dragstart=(view,event)=>{let {selection:{main}}=view.state,{mouseSelection}=view.inputState;mouseSelection&&(mouseSelection.dragging=main);event.dataTransfer&&
(event.dataTransfer.setData("Text",view.state.sliceDoc(main.from,main.to)),event.dataTransfer.effectAllowed="copyMove")};handlers.drop=(view,event)=>{if(event.dataTransfer&&view.state.facet(editable)){var files=event.dataTransfer.files;if(files&&files.length){event.preventDefault();let text=Array(files.length),read=0,finishFile=()=>{++read==files.length&&dropText(view,event,text.filter(s=>null!=s).join(view.state.lineBreak),!1)};for(let i=0;i<files.length;i++){let reader=new FileReader;reader.onerror=
finishFile;reader.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(reader.result)||(text[i]=reader.result);finishFile()};reader.readAsText(files[i])}}else dropText(view,event,event.dataTransfer.getData("Text"),!0)}};handlers.paste=(view,event)=>{if(view.state.facet(editable)){view.observer.flush();var data=brokenClipboardAPI?null:event.clipboardData;(data=data&&data.getData("text/plain"))?(doPaste(view,data),event.preventDefault()):capturePaste(view)}};let lastLinewiseCopy=null;handlers.copy=handlers.cut=
(view,event)=>{var JSCompiler_inline_result=view.state;let content=[],ranges=[];var linewise=!1;for(var range of JSCompiler_inline_result.selection.ranges)range.empty||(content.push(JSCompiler_inline_result.sliceDoc(range.from,range.to)),ranges.push(range));if(!content.length){linewise=-1;for(let {from}of JSCompiler_inline_result.selection.ranges)range=JSCompiler_inline_result.doc.lineAt(from),range.number>linewise&&(content.push(range.text),ranges.push({from:range.from,to:Math.min(JSCompiler_inline_result.doc.length,
range.to+1)})),linewise=range.number;linewise=!0}JSCompiler_inline_result={text:content.join(JSCompiler_inline_result.lineBreak),ranges,linewise};let {text,ranges:ranges$jscomp$0,linewise:linewise$jscomp$0}=JSCompiler_inline_result;text&&(lastLinewiseCopy=linewise$jscomp$0?text:null,(JSCompiler_inline_result=brokenClipboardAPI?null:event.clipboardData)?(event.preventDefault(),JSCompiler_inline_result.clearData(),JSCompiler_inline_result.setData("text/plain",text)):captureCopy(view,text),"cut"==event.type&&
view.state.facet(editable)&&view.dispatch({changes:ranges$jscomp$0,scrollIntoView:!0,annotations:state$jscomp$0.Transaction.userEvent.of("cut")}))};handlers.focus=handlers.blur=view=>{setTimeout(()=>{view.hasFocus!=view.inputState.notifiedFocused&&view.update([])},10)};handlers.beforeprint=view=>{view.viewState.printing=!0;view.requestMeasure();setTimeout(()=>{view.viewState.printing=!1;view.requestMeasure()},2E3)};handlers.compositionstart=handlers.compositionupdate=view=>{0>view.inputState.composing&&
(view.docView.compositionDeco.size&&(view.observer.flush(),view.docView.compositionDeco.size&&view.update([])),view.inputState.composing=0)};handlers.compositionend=view=>{view.inputState.composing=-1;view.inputState.compositionEndedAt=Date.now();setTimeout(()=>{0>view.inputState.composing&&view.docView.compositionDeco.size&&view.update([])},50)};handlers.contextmenu=view=>{view.inputState.lastContextMenu=Date.now()};const wrappingWhiteSpace=["pre-wrap","normal","pre-line"];class HeightOracle{constructor(){this.doc=
text$jscomp$0.Text.empty;this.lineWrapping=!1;this.direction=exports.Direction.LTR;this.heightSamples={};this.lineHeight=14;this.charWidth=7;this.lineLength=30;this.heightChanged=!1}heightForGap(from,to){let lines=this.doc.lineAt(to).number-this.doc.lineAt(from).number+1;this.lineWrapping&&(lines+=Math.ceil((to-from-lines*this.lineLength*.5)/this.lineLength));return this.lineHeight*lines}heightForLine(length){return this.lineWrapping?(1+Math.max(0,Math.ceil((length-this.lineLength)/(this.lineLength-
5))))*this.lineHeight:this.lineHeight}setDoc(doc){this.doc=doc;return this}mustRefresh(lineHeights,whiteSpace,direction){let newHeight=!1;for(let i=0;i<lineHeights.length;i++){let h=lineHeights[i];0>h?i++:this.heightSamples[Math.floor(10*h)]||(newHeight=!0,this.heightSamples[Math.floor(10*h)]=!0)}return newHeight||-1<wrappingWhiteSpace.indexOf(whiteSpace)!=this.lineWrapping||this.direction!=direction}refresh(whiteSpace,direction,lineHeight,charWidth,lineLength,knownHeights){let lineWrapping=-1<wrappingWhiteSpace.indexOf(whiteSpace);
whiteSpace=Math.round(lineHeight)!=Math.round(this.lineHeight)||this.lineWrapping!=lineWrapping||this.direction!=direction;this.lineWrapping=lineWrapping;this.direction=direction;this.lineHeight=lineHeight;this.charWidth=charWidth;this.lineLength=lineLength;if(whiteSpace)for(this.heightSamples={},direction=0;direction<knownHeights.length;direction++)lineHeight=knownHeights[direction],0>lineHeight?direction++:this.heightSamples[Math.floor(10*lineHeight)]=!0;return whiteSpace}}class MeasuredHeights{constructor(from,
heights){this.from=from;this.heights=heights;this.index=0}get more(){return this.index<this.heights.length}}class BlockInfo{constructor(from,length,top,height,type){this.from=from;this.length=length;this.top=top;this.height=height;this.type=type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}join(other){let detail=(Array.isArray(this.type)?this.type:[this]).concat(Array.isArray(other.type)?other.type:[other]);return new BlockInfo(this.from,this.length+other.length,
this.top,this.height+other.height,detail)}}var QueryType;(function(QueryType){QueryType[QueryType.ByPos=0]="ByPos";QueryType[QueryType.ByHeight=1]="ByHeight";QueryType[QueryType.ByPosNoHeight=2]="ByPosNoHeight"})(QueryType||(QueryType={}));class HeightMap{constructor(length,height,flags=2){this.length=length;this.height=height;this.flags=flags}get outdated(){return 0<(this.flags&2)}set outdated(value){this.flags=(value?2:0)|this.flags&-3}setHeight(oracle,height){this.height!=height&&(1E-4<Math.abs(this.height-
height)&&(oracle.heightChanged=!0),this.height=height)}replace(_from,_to,nodes){return HeightMap.of(nodes)}decomposeLeft(_to,result){result.push(this)}decomposeRight(_from,result){result.push(this)}applyChanges(decorations,oldDoc,oracle,changes){let me=this;for(let i=changes.length-1;0<=i;i--){let {fromA,toA,fromB,toB}=changes[i];var start=me.lineAt(fromA,QueryType.ByPosNoHeight,oldDoc,0,0);let end=start.to>=toA?start:me.lineAt(toA,QueryType.ByPosNoHeight,oldDoc,0,0);toB+=end.to-toA;for(toA=end.to;0<
i&&start.from<=changes[i-1].toA;)fromA=changes[i-1].fromA,fromB=changes[i-1].fromB,i--,fromA<start.from&&(start=me.lineAt(fromA,QueryType.ByPosNoHeight,oldDoc,0,0));fromB+=start.from-fromA;fromA=start.from;start=NodeBuilder.build(oracle,decorations,fromB,toB);me=me.replace(fromA,toA,start)}return me.updateHeight(oracle,0)}static empty(){return new HeightMapText(0,0)}static of(nodes){if(1==nodes.length)return nodes[0];let i=0,j=nodes.length;var before=0;let after=0;for(;;)if(i==j)if(before>2*after){var split=
nodes[i-1];split.break?nodes.splice(--i,1,split.left,null,split.right):nodes.splice(--i,1,split.left,split.right);j+=1+split.break;before-=split.size}else if(after>2*before)split=nodes[j],split.break?nodes.splice(j,1,split.left,null,split.right):nodes.splice(j,1,split.left,split.right),j+=2+split.break,after-=split.size;else break;else before<after?(split=nodes[i++])&&(before+=split.size):(split=nodes[--j])&&(after+=split.size);before=0;null==nodes[i-1]?(before=1,i--):null==nodes[i]&&(before=1,j++);
return new HeightMapBranch(HeightMap.of(nodes.slice(0,i)),before,HeightMap.of(nodes.slice(j)))}}HeightMap.prototype.size=1;class HeightMapBlock extends HeightMap{constructor(length,height,type){super(length,height);this.type=type}blockAt(_height,_doc,top,offset){return new BlockInfo(offset,this.length,top,this.height,this.type)}lineAt(_value,_type,doc,top,offset){return this.blockAt(0,doc,top,offset)}forEachLine(_from,_to,doc,top,offset,f){f(this.blockAt(0,doc,top,offset))}updateHeight(oracle,offset=
0,_force,measured){measured&&measured.from<=offset&&measured.more&&this.setHeight(oracle,measured.heights[measured.index++]);this.outdated=!1;return this}toString(){return`block(${this.length})`}}class HeightMapText extends HeightMapBlock{constructor(length,height){super(length,height,exports.BlockType.Text);this.widgetHeight=this.collapsed=0}replace(_from,_to,nodes){_from=nodes[0];return 1==nodes.length&&(_from instanceof HeightMapText||_from instanceof HeightMapGap&&_from.flags&4)&&10>Math.abs(this.length-
_from.length)?(_from instanceof HeightMapGap?_from=new HeightMapText(_from.length,this.height):_from.height=this.height,this.outdated||(_from.outdated=!1),_from):HeightMap.of(nodes)}updateHeight(oracle,offset=0,force=!1,measured){measured&&measured.from<=offset&&measured.more?this.setHeight(oracle,measured.heights[measured.index++]):(force||this.outdated)&&this.setHeight(oracle,Math.max(this.widgetHeight,oracle.heightForLine(this.length-this.collapsed)));this.outdated=!1;return this}toString(){return`line(${this.length}${this.collapsed?
-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class HeightMapGap extends HeightMap{constructor(length){super(length,0)}lines(doc,offset){let firstLine=doc.lineAt(offset).number;doc=doc.lineAt(offset+this.length).number;return{firstLine,lastLine:doc,lineHeight:this.height/(doc-firstLine+1)}}blockAt(height,doc,top,offset){let {firstLine,lastLine,lineHeight}=this.lines(doc,offset);height=Math.max(0,Math.min(lastLine-firstLine,Math.floor((height-top)/lineHeight)));let {from,length}=
doc.line(firstLine+height);return new BlockInfo(from,length,top+lineHeight*height,lineHeight,exports.BlockType.Text)}lineAt(value,type,doc,top,offset){if(type==QueryType.ByHeight)return this.blockAt(value,doc,top,offset);if(type==QueryType.ByPosNoHeight){let {from,to}=doc.lineAt(value);return new BlockInfo(from,to-from,0,0,exports.BlockType.Text)}let {firstLine,lineHeight}=this.lines(doc,offset),{from:from$jscomp$0,length,number}=doc.lineAt(value);return new BlockInfo(from$jscomp$0,length,top+lineHeight*
(number-firstLine),lineHeight,exports.BlockType.Text)}forEachLine(from,to,doc,top,offset,f){let {firstLine,lineHeight}=this.lines(doc,offset);for(let pos=Math.max(from,offset),end=Math.min(offset+this.length,to);pos<=end;)to=doc.lineAt(pos),pos==from&&(top+=lineHeight*(to.number-firstLine)),f(new BlockInfo(to.from,to.length,top,lineHeight,exports.BlockType.Text)),top+=lineHeight,pos=to.to+1}replace(from,to,nodes){to=this.length-to;if(0<to){let last=nodes[nodes.length-1];last instanceof HeightMapGap?
nodes[nodes.length-1]=new HeightMapGap(last.length+to):nodes.push(null,new HeightMapGap(to-1))}0<from&&(to=nodes[0],to instanceof HeightMapGap?nodes[0]=new HeightMapGap(from+to.length):nodes.unshift(new HeightMapGap(from-1),null));return HeightMap.of(nodes)}decomposeLeft(to,result){result.push(new HeightMapGap(to-1),null)}decomposeRight(from,result){result.push(null,new HeightMapGap(this.length-from-1))}updateHeight(oracle,offset=0,force=!1,measured){let end=offset+this.length;if(measured&&measured.from<=
offset+this.length&&measured.more){force=[];let pos=Math.max(offset,measured.from);for(measured.from>offset&&force.push((new HeightMapGap(measured.from-offset-1)).updateHeight(oracle,offset));pos<=end&&measured.more;){offset=oracle.doc.lineAt(pos).length;force.length&&force.push(null);let line=new HeightMapText(offset,measured.heights[measured.index++]);line.outdated=!1;force.push(line);pos+=offset+1}pos<=end&&force.push(null,(new HeightMapGap(end-pos)).updateHeight(oracle,pos));oracle.heightChanged=
!0;return HeightMap.of(force)}if(force||this.outdated)this.setHeight(oracle,oracle.heightForGap(offset,offset+this.length)),this.outdated=!1;return this}toString(){return`gap(${this.length})`}}class HeightMapBranch extends HeightMap{constructor(left,brk,right){super(left.length+brk+right.length,left.height+right.height,brk|(left.outdated||right.outdated?2:0));this.left=left;this.right=right;this.size=left.size+right.size}get break(){return this.flags&1}blockAt(height,doc,top,offset){let mid=top+this.left.height;
return height<mid||0==this.right.height?this.left.blockAt(height,doc,top,offset):this.right.blockAt(height,doc,mid,offset+this.left.length+this.break)}lineAt(value,type,doc,top,offset){let rightTop=top+this.left.height,rightOffset=offset+this.left.length+this.break,left=type==QueryType.ByHeight?value<rightTop||0==this.right.height:value<rightOffset;value=left?this.left.lineAt(value,type,doc,top,offset):this.right.lineAt(value,type,doc,rightTop,rightOffset);if(this.break||(left?value.to<rightOffset:
value.from>rightOffset))return value;type=type==QueryType.ByPosNoHeight?QueryType.ByPosNoHeight:QueryType.ByPos;return left?value.join(this.right.lineAt(rightOffset,type,doc,rightTop,rightOffset)):this.left.lineAt(rightOffset,type,doc,top,offset).join(value)}forEachLine(from,to,doc,top,offset,f){let rightTop=top+this.left.height,rightOffset=offset+this.left.length+this.break;if(this.break)from<rightOffset&&this.left.forEachLine(from,to,doc,top,offset,f),to>=rightOffset&&this.right.forEachLine(from,
to,doc,rightTop,rightOffset,f);else{let mid=this.lineAt(rightOffset,QueryType.ByPos,doc,top,offset);from<mid.from&&this.left.forEachLine(from,mid.from-1,doc,top,offset,f);mid.to>=from&&mid.from<=to&&f(mid);to>mid.to&&this.right.forEachLine(mid.to+1,to,doc,rightTop,rightOffset,f)}}replace(from,to,nodes){var rightStart=this.left.length+this.break;if(to<rightStart)return this.balanced(this.left.replace(from,to,nodes),this.right);if(from>this.left.length)return this.balanced(this.left,this.right.replace(from-
rightStart,to-rightStart,nodes));rightStart=[];0<from&&this.decomposeLeft(from,rightStart);let left=rightStart.length;for(let node of nodes)rightStart.push(node);0<from&&mergeGaps(rightStart,left-1);to<this.length&&(from=rightStart.length,this.decomposeRight(to,rightStart),mergeGaps(rightStart,from));return HeightMap.of(rightStart)}decomposeLeft(to,result){let left=this.left.length;if(to<=left)return this.left.decomposeLeft(to,result);result.push(this.left);this.break&&(left++,to>=left&&result.push(null));
to>left&&this.right.decomposeLeft(to-left,result)}decomposeRight(from,result){let left=this.left.length,right=left+this.break;if(from>=right)return this.right.decomposeRight(from-right,result);from<left&&this.left.decomposeRight(from,result);this.break&&from<right&&result.push(null);result.push(this.right)}balanced(left,right){if(left.size>2*right.size||right.size>2*left.size)return HeightMap.of(this.break?[left,null,right]:[left,right]);this.left=left;this.right=right;this.height=left.height+right.height;
this.outdated=left.outdated||right.outdated;this.size=left.size+right.size;this.length=left.length+this.break+right.length;return this}updateHeight(oracle,offset=0,force=!1,measured){let {left,right}=this,rightStart=offset+left.length+this.break,rebalance=null;measured&&measured.from<=offset+left.length&&measured.more?rebalance=left=left.updateHeight(oracle,offset,force,measured):left.updateHeight(oracle,offset,force);measured&&measured.from<=rightStart+right.length&&measured.more?rebalance=right=
right.updateHeight(oracle,rightStart,force,measured):right.updateHeight(oracle,rightStart,force);if(rebalance)return this.balanced(left,right);this.height=this.left.height+this.right.height;this.outdated=!1;return this}toString(){return this.left+(this.break?" ":"-")+this.right}}class NodeBuilder{constructor(pos,oracle){this.pos=pos;this.oracle=oracle;this.nodes=[];this.lineEnd=this.lineStart=-1;this.covering=null;this.writtenTo=pos}get isCovered(){return this.covering&&this.nodes[this.nodes.length-
1]==this.covering}span(_from,to){if(-1<this.lineStart){_from=Math.min(to,this.lineEnd);let last=this.nodes[this.nodes.length-1];last instanceof HeightMapText?last.length+=_from-this.pos:(_from>this.pos||!this.isCovered)&&this.nodes.push(new HeightMapText(_from-this.pos,-1));this.writtenTo=_from;to>_from&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=to}point(from,to,deco){if(from<to||deco.heightRelevant){let height=deco.widget?Math.max(0,deco.widget.estimatedHeight):0;from=to-
from;deco.block?this.addBlock(new HeightMapBlock(from,height,deco.type)):(from||5<=height)&&this.addLineDeco(height,from)}else to>from&&this.span(from,to);-1<this.lineEnd&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(!(-1<this.lineStart)){var {from,to}=this.oracle.doc.lineAt(this.pos);this.lineStart=from;this.lineEnd=to;this.writtenTo<from&&((this.writtenTo<from-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,
from-1)),this.nodes.push(null));this.pos>from&&this.nodes.push(new HeightMapText(this.pos-from,-1));this.writtenTo=this.pos}}blankContent(from,to){let gap=new HeightMapGap(to-from);this.oracle.doc.lineAt(from).to==to&&(gap.flags|=4);return gap}ensureLine(){this.enterLine();var last=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(last instanceof HeightMapText)return last;last=new HeightMapText(0,-1);this.nodes.push(last);return last}addBlock(block){this.enterLine();block.type!=exports.BlockType.WidgetAfter||
this.isCovered||this.ensureLine();this.nodes.push(block);this.writtenTo=this.pos+=block.length;block.type!=exports.BlockType.WidgetBefore&&(this.covering=block)}addLineDeco(height,length){let line=this.ensureLine();line.length+=length;line.collapsed+=length;line.widgetHeight=Math.max(line.widgetHeight,height);this.writtenTo=this.pos+=length}finish(from){let last=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(-1<this.lineStart)||last instanceof HeightMapText||this.isCovered?(this.writtenTo<
this.pos||null==last)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new HeightMapText(0,-1));for(let node of this.nodes)node instanceof HeightMapText&&node.updateHeight(this.oracle,from),from+=node?node.length:1;return this.nodes}static build(oracle,decorations,from,to){oracle=new NodeBuilder(from,oracle);rangeset.RangeSet.spans(decorations,from,to,oracle,0);return oracle.finish(from)}}class DecorationComparator{constructor(){this.changes=[]}compareRange(){}comparePoint(from,
to,a,b){(from<to||a&&a.heightRelevant||b&&b.heightRelevant)&&addRange(from,to,this.changes,5)}}class LineGap{constructor(from,to,size){this.from=from;this.to=to;this.size=size}static same(a,b){if(a.length!=b.length)return!1;for(let i=0;i<a.length;i++){let gA=a[i],gB=b[i];if(gA.from!=gB.from||gA.to!=gB.to||gA.size!=gB.size)return!1}return!0}draw(wrapping){return Decoration.replace({widget:new LineGapWidget(this.size,wrapping)}).range(this.from,this.to)}}class LineGapWidget extends WidgetType{constructor(size,
vertical){super();this.size=size;this.vertical=vertical}eq(other){return other.size==this.size&&other.vertical==this.vertical}toDOM(){let elt=document.createElement("div");this.vertical?elt.style.height=this.size+"px":(elt.style.width=this.size+"px",elt.style.height="2px",elt.style.display="inline-block");return elt}get estimatedHeight(){return this.vertical?this.size:-1}}class ViewState{constructor(state){this.state=state;this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0};this.inView=
!0;this.contentWidth=this.paddingBottom=this.paddingTop=0;this.heightOracle=new HeightOracle;this.scaler=IdScaler;this.scrollTo=null;this.printing=!1;this.visibleRanges=[];this.mustEnforceCursorAssoc=!1;this.heightMap=HeightMap.empty().applyChanges(state.facet(decorations),text$jscomp$0.Text.empty,this.heightOracle.setDoc(state.doc),[new ChangedRange(0,0,0,state.doc.length)]);this.viewport=this.getViewport(0,null);this.updateForViewport();this.lineGaps=this.ensureLineGaps([]);this.lineGapDeco=Decoration.set(this.lineGaps.map(gap=>
gap.draw(!1)));this.computeVisibleRanges()}updateForViewport(){let viewports=[this.viewport],{main}=this.state.selection;for(let i=0;1>=i;i++){let pos=i?main.head:main.anchor;if(!viewports.some(({from,to})=>pos>=from&&pos<=to)){let {from,to}=this.lineAt(pos,0);viewports.push(new Viewport(from,to))}}this.viewports=viewports.sort((a,b)=>a.from-b.from);this.scaler=7E6>=this.heightMap.height?IdScaler:new BigScaler(this.heightOracle.doc,this.heightMap,this.viewports)}update(update,scrollTo=null){var prev=
this.state;this.state=update.state;let newDeco=this.state.facet(decorations);var contentChanges=update.changedRanges,JSCompiler_temp_const=ChangedRange,JSCompiler_temp_const$jscomp$0=JSCompiler_temp_const.extendWithRanges,a=update.startState.facet(decorations),diff=update?update.changes:state$jscomp$0.ChangeSet.empty(this.state.doc.length);let comp=new DecorationComparator;rangeset.RangeSet.compare(a,newDeco,diff,comp,0);contentChanges=JSCompiler_temp_const$jscomp$0.call(JSCompiler_temp_const,contentChanges,
comp.changes);JSCompiler_temp_const=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(newDeco,prev.doc,this.heightOracle.setDoc(this.state.doc),contentChanges);this.heightMap.height!=JSCompiler_temp_const&&(update.flags|=2);prev=contentChanges.length?this.mapViewport(this.viewport,update.changes):this.viewport;if(scrollTo&&(scrollTo.head<prev.from||scrollTo.head>prev.to)||!this.viewportIsAppropriate(prev))prev=this.getViewport(0,scrollTo);prev.eq(this.viewport)||(this.viewport=prev,
update.flags|=4);this.updateForViewport();if(this.lineGaps.length||15E3<this.viewport.to-this.viewport.from)update.flags|=this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,update.changes)));this.computeVisibleRanges();scrollTo&&(this.scrollTo=scrollTo);!this.mustEnforceCursorAssoc&&update.selectionSet&&update.view.lineWrapping&&update.state.selection.main.empty&&update.state.selection.main.assoc&&(this.mustEnforceCursorAssoc=!0)}measure(docView,repeated){var dom=docView.dom,whiteSpace=
"";let direction=exports.Direction.LTR;if(!repeated){var style$jscomp$0=window.getComputedStyle(dom);whiteSpace=style$jscomp$0.whiteSpace;direction="rtl"==style$jscomp$0.direction?exports.Direction.RTL:exports.Direction.LTR;this.paddingTop=parseInt(style$jscomp$0.paddingTop)||0;this.paddingBottom=parseInt(style$jscomp$0.paddingBottom)||0}if(this.printing)style$jscomp$0={top:-1E8,bottom:1E8,left:-1E8,right:1E8};else{style$jscomp$0=this.paddingTop;var rect=dom.getBoundingClientRect(),left=Math.max(0,
rect.left),right=Math.min(innerWidth,rect.right),top=Math.max(0,rect.top),bottom=Math.min(innerHeight,rect.bottom);for(dom=dom.parentNode;dom;)if(1==dom.nodeType){let style=window.getComputedStyle(dom);if((dom.scrollHeight>dom.clientHeight||dom.scrollWidth>dom.clientWidth)&&"visible"!=style.overflow){let parentRect=dom.getBoundingClientRect();left=Math.max(left,parentRect.left);right=Math.min(right,parentRect.right);top=Math.max(top,parentRect.top);bottom=Math.min(bottom,parentRect.bottom)}dom="absolute"==
style.position||"fixed"==style.position?dom.offsetParent:dom.parentNode}else if(11==dom.nodeType)dom=dom.host;else break;style$jscomp$0={left:left-rect.left,right:right-rect.left,top:top-(rect.top+style$jscomp$0),bottom:bottom-(rect.top+style$jscomp$0)}}left=style$jscomp$0;style$jscomp$0=left.top-this.pixelViewport.top;rect=left.bottom-this.pixelViewport.bottom;this.pixelViewport=left;this.inView=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(!this.inView)return 0;
top=docView.measureVisibleLineHeights();left=!1;right=bottom=0;dom=this.heightOracle;if(!repeated){repeated=docView.dom.clientWidth;if(dom.mustRefresh(top,whiteSpace,direction)||dom.lineWrapping&&Math.abs(repeated-this.contentWidth)>dom.charWidth){let {lineHeight,charWidth}=docView.measureTextSize();if(left=dom.refresh(whiteSpace,direction,lineHeight,charWidth,repeated/charWidth,top))docView.minWidth=0,right|=16}this.contentWidth!=repeated&&(this.contentWidth=repeated,right|=16);0<style$jscomp$0&&
0<rect?bottom=Math.max(style$jscomp$0,rect):0>style$jscomp$0&&0>rect&&(bottom=Math.min(style$jscomp$0,rect))}dom.heightChanged=!1;this.heightMap=this.heightMap.updateHeight(dom,0,left,new MeasuredHeights(this.viewport.from,top));dom.heightChanged&&(right|=2);if(!this.viewportIsAppropriate(this.viewport,bottom)||this.scrollTo&&(this.scrollTo.head<this.viewport.from||this.scrollTo.head>this.viewport.to))if(whiteSpace=this.getViewport(bottom,this.scrollTo),whiteSpace.from!=this.viewport.from||whiteSpace.to!=
this.viewport.to)this.viewport=whiteSpace,right|=4;this.updateForViewport();if(this.lineGaps.length||15E3<this.viewport.to-this.viewport.from)right|=this.updateLineGaps(this.ensureLineGaps(left?[]:this.lineGaps));this.computeVisibleRanges();this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,docView.enforceCursorAssoc());return right}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top,0)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom,0)}getViewport(bias,
scrollTo){var marginTop=.5-Math.max(-.5,Math.min(.5,bias/1E3/2));bias=this.heightMap;let doc=this.state.doc,{visibleTop,visibleBottom}=this;marginTop=new Viewport(bias.lineAt(visibleTop-1E3*marginTop,QueryType.ByHeight,doc,0,0).from,bias.lineAt(visibleBottom+1E3*(1-marginTop),QueryType.ByHeight,doc,0,0).to);scrollTo&&(scrollTo.head<marginTop.from?({top:scrollTo}=bias.lineAt(scrollTo.head,QueryType.ByPos,doc,0,0),marginTop=new Viewport(bias.lineAt(scrollTo-500,QueryType.ByHeight,doc,0,0).from,bias.lineAt(scrollTo+
(visibleBottom-visibleTop)+500,QueryType.ByHeight,doc,0,0).to)):scrollTo.head>marginTop.to&&({bottom:scrollTo}=bias.lineAt(scrollTo.head,QueryType.ByPos,doc,0,0),marginTop=new Viewport(bias.lineAt(scrollTo-(visibleBottom-visibleTop)-500,QueryType.ByHeight,doc,0,0).from,bias.lineAt(scrollTo+500,QueryType.ByHeight,doc,0,0).to)));return marginTop}mapViewport(viewport,changes){let from=changes.mapPos(viewport.from,-1);viewport=changes.mapPos(viewport.to,1);return new Viewport(this.heightMap.lineAt(from,
QueryType.ByPos,this.state.doc,0,0).from,this.heightMap.lineAt(viewport,QueryType.ByPos,this.state.doc,0,0).to)}viewportIsAppropriate({from,to},bias=0){let {top}=this.heightMap.lineAt(from,QueryType.ByPos,this.state.doc,0,0),{bottom}=this.heightMap.lineAt(to,QueryType.ByPos,this.state.doc,0,0),{visibleTop,visibleBottom}=this;return(0==from||top<=visibleTop-Math.max(10,Math.min(-bias,250)))&&(to==this.state.doc.length||bottom>=visibleBottom+Math.max(10,Math.min(bias,250)))&&top>visibleTop-2E3&&bottom<
visibleBottom+2E3}mapLineGaps(gaps,changes){if(!gaps.length||changes.empty)return gaps;let mapped=[];for(let gap of gaps)changes.touchesRange(gap.from,gap.to)||mapped.push(new LineGap(changes.mapPos(gap.from),changes.mapPos(gap.to),gap.size));return mapped}ensureLineGaps(current){let gaps=[];if(this.heightOracle.direction!=exports.Direction.LTR)return gaps;this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.state.doc,0,0,line=>{if(!(1E4>line.length)){var structure=lineStructure(line.from,
line.to,this.state);if(!(1E4>structure.total)){if(this.heightOracle.lineWrapping){var viewFrom=line.from!=this.viewport.from?line.from:findPosition(structure,(this.visibleTop-line.top)/line.height);var viewTo=line.to!=this.viewport.to?line.to:findPosition(structure,(this.visibleBottom-line.top)/line.height)}else viewTo=structure.total*this.heightOracle.charWidth,viewFrom=findPosition(structure,this.pixelViewport.left/viewTo),viewTo=findPosition(structure,this.pixelViewport.right/viewTo);var sel=this.state.selection.main;
sel.from<=viewFrom&&sel.to>=line.from&&(viewFrom=sel.from);sel.from<=line.to&&sel.to>=viewTo&&(viewTo=sel.to);var gapTo=viewFrom-1E4,gapFrom=viewTo+1E4;gapTo>line.from+5E3&&gaps.push(find(current,gap=>gap.from==line.from&&gap.to>gapTo-5E3&&gap.to<gapTo+5E3)||new LineGap(line.from,gapTo,this.gapSize(line,gapTo,!0,structure)));gapFrom<line.to-5E3&&gaps.push(find(current,gap=>gap.to==line.to&&gap.from>gapFrom-5E3&&gap.from<gapFrom+5E3)||new LineGap(gapFrom,line.to,this.gapSize(line,gapFrom,!1,structure)))}}});
return gaps}gapSize(line,pos,start,structure){if(this.heightOracle.lineWrapping)return structure=line.height*findFraction(structure,pos),start?structure:line.height-structure;line=findFraction(structure,pos);return structure.total*this.heightOracle.charWidth*(start?line:1-line)}updateLineGaps(gaps){return LineGap.same(gaps,this.lineGaps)?0:(this.lineGaps=gaps,this.lineGapDeco=Decoration.set(gaps.map(gap=>gap.draw(this.heightOracle.lineWrapping))),8)}computeVisibleRanges(){let deco=this.state.facet(decorations);
this.lineGaps.length&&(deco=deco.concat(this.lineGapDeco));let ranges=[];rangeset.RangeSet.spans(deco,this.viewport.from,this.viewport.to,{span(from,to){ranges.push({from,to})},point(){}},20);this.visibleRanges=ranges}lineAt(pos,editorTop){editorTop+=this.paddingTop;return scaleBlock(this.heightMap.lineAt(pos,QueryType.ByPos,this.state.doc,editorTop,0),this.scaler,editorTop)}lineAtHeight(height,editorTop){editorTop+=this.paddingTop;return scaleBlock(this.heightMap.lineAt(this.scaler.fromDOM(height,
editorTop),QueryType.ByHeight,this.state.doc,editorTop,0),this.scaler,editorTop)}blockAtHeight(height,editorTop){editorTop+=this.paddingTop;return scaleBlock(this.heightMap.blockAt(this.scaler.fromDOM(height,editorTop),this.state.doc,editorTop,0),this.scaler,editorTop)}forEachLine(from,to,f,editorTop){editorTop+=this.paddingTop;return this.heightMap.forEachLine(from,to,this.state.doc,editorTop,0,1==this.scaler.scale?f:b=>f(scaleBlock(b,this.scaler,editorTop)))}get contentHeight(){return this.domHeight+
this.paddingTop+this.paddingBottom}get domHeight(){return this.scaler.toDOM(this.heightMap.height,this.paddingTop)}}class Viewport{constructor(from,to){this.from=from;this.to=to}eq(b){return this.from==b.from&&this.to==b.to}}const IdScaler={toDOM(n){return n},fromDOM(n){return n},scale:1};class BigScaler{constructor(doc,heightMap,viewports){let vpHeight=0,base=0,domBase=0;this.viewports=viewports.map(({from,to})=>{let top=heightMap.lineAt(from,QueryType.ByPos,doc,0,0).top,bottom=heightMap.lineAt(to,
QueryType.ByPos,doc,0,0).bottom;vpHeight+=bottom-top;return{from,to,top,bottom,domTop:0,domBottom:0}});this.scale=(7E6-vpHeight)/(heightMap.height-vpHeight);for(let obj of this.viewports)obj.domTop=domBase+(obj.top-base)*this.scale,domBase=obj.domBottom=obj.domTop+(obj.bottom-obj.top),base=obj.bottom}toDOM(n,top){n-=top;for(let i=0,base=0,domBase=0;;i++){let vp=i<this.viewports.length?this.viewports[i]:null;if(!vp||n<vp.top)return domBase+(n-base)*this.scale+top;if(n<=vp.bottom)return vp.domTop+(n-
vp.top)+top;base=vp.bottom;domBase=vp.domBottom}}fromDOM(n,top){n-=top;for(let i=0,base=0,domBase=0;;i++){let vp=i<this.viewports.length?this.viewports[i]:null;if(!vp||n<vp.domTop)return base+(n-domBase)/this.scale+top;if(n<=vp.domBottom)return vp.top+(n-vp.domTop)+top;base=vp.bottom;domBase=vp.domBottom}}}const theme=state$jscomp$0.Facet.define({combine:strs=>strs.join(" ")}),darkTheme=state$jscomp$0.Facet.define({combine:values=>-1<values.indexOf(!0)}),baseThemeID=styleMod.StyleModule.newName(),
baseLightID=styleMod.StyleModule.newName(),baseDarkID=styleMod.StyleModule.newName(),lightDarkIDs={"\x26light":"."+baseLightID,"\x26dark":"."+baseDarkID},baseTheme=buildTheme("."+baseThemeID,{"\x26":{position:"relative !important",boxSizing:"border-box","\x26.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",
zIndex:0},".cm-content":{margin:0,flexGrow:2,minHeight:"100%",display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none"},".cm-lineWrapping":{whiteSpace:"pre-wrap",overflowWrap:"anywhere"},"\x26light .cm-content":{caretColor:"black"},"\x26dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 4px"},".cm-selectionLayer":{zIndex:-1,contain:"size style"},".cm-selectionBackground":{position:"absolute"},"\x26light .cm-selectionBackground":{background:"#d9d9d9"},
"\x26dark .cm-selectionBackground":{background:"#222"},"\x26light.cm-focused .cm-selectionBackground":{background:"#d7d4f0"},"\x26dark.cm-focused .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{zIndex:100,contain:"size style",pointerEvents:"none"},"\x26.cm-focused .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},".cm-cursor":{position:"absolute",
borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none",display:"none"},"\x26dark .cm-cursor":{borderLeftColor:"#444"},"\x26.cm-focused .cm-cursor":{display:"block"},"\x26light .cm-activeLine":{backgroundColor:"#f3f9ff"},"\x26dark .cm-activeLine":{backgroundColor:"#223039"},"\x26light .cm-specialChar":{color:"red"},"\x26dark .cm-specialChar":{color:"#f78"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-placeholder":{color:"#888",display:"inline-block"},
".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"3px"},"\x26light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","\x26:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"\x26dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","\x26:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",
border:"1px solid silver",padding:".2em .5em"},"\x26light .cm-textfield":{backgroundColor:"white"},"\x26dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},lightDarkIDs),observeOptions={childList:!0,characterData:!0,subtree:!0,characterDataOldValue:!0},useCharData=browser.ie&&11>=browser.ie_version;class DOMObserver{constructor(view,onChange,onScrollChanged){this.view=view;this.onChange=onChange;this.onScrollChanged=onScrollChanged;this.active=!1;this.ignoreSelection=new DOMSelection;
this.delayedFlush=-1;this.queue=[];this.lastFlush=0;this.scrollTargets=[];this.intersection=null;this.intersecting=!1;this._selectionRange=null;this.parentCheck=-1;this.dom=view.contentDOM;this.observer=new MutationObserver(mutations=>{for(let mut of mutations)this.queue.push(mut);this._selectionRange=null;(browser.ie&&11>=browser.ie_version||browser.ios&&view.composing)&&mutations.some(m=>"childList"==m.type&&m.removedNodes.length||"characterData"==m.type&&m.oldValue.length>m.target.nodeValue.length)?
this.flushSoon():this.flush()});useCharData&&(this.onCharData=event=>{this.queue.push({target:event.target,type:"characterData",oldValue:event.prevValue});this.flushSoon()});this.onSelectionChange=this.onSelectionChange.bind(this);this.start();this.onScroll=this.onScroll.bind(this);window.addEventListener("scroll",this.onScroll);"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver(entries=>{0>this.parentCheck&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),
1E3));if(0<entries[entries.length-1].intersectionRatio!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView))this.onScrollChanged(document.createEvent("Event"))},{}),this.intersection.observe(this.dom));this.listenForScroll()}onScroll(e){this.intersecting&&this.flush();this.onScrollChanged(e)}onSelectionChange(event){this.lastFlush<Date.now()-50&&(this._selectionRange=null);let {view}=this,sel=this.selectionRange;if(view.state.facet(editable)?view.root.activeElement==
this.dom:hasSelection(view.dom,sel)){var context=sel.anchorNode&&view.docView.nearest(sel.anchorNode);context&&context.ignoreEvent(event)||(browser.ie&&11>=browser.ie_version&&!view.state.selection.main.empty&&sel.focusNode&&isEquivalentPosition(sel.focusNode,sel.focusOffset,sel.anchorNode,sel.anchorOffset)?this.flushSoon():this.flush())}}get selectionRange(){if(!this._selectionRange){var {root}=this.view;let sel=getSelection(root);if(root=browser.safari&&11==root.nodeType){for(root=document.activeElement;root&&
root.shadowRoot;)root=root.shadowRoot.activeElement;root=root==this.view.contentDOM}root&&(sel=safariSelectionRangeHack(this.view)||sel);this._selectionRange=sel}return this._selectionRange}setSelectionRange(anchor,head){var _a;null!==(_a=this._selectionRange)&&void 0!==_a&&_a.type||(this._selectionRange={anchorNode:anchor.node,anchorOffset:anchor.offset,focusNode:head.node,focusOffset:head.offset})}listenForScroll(){this.parentCheck=-1;let i=0,changed=null;for(let dom=this.dom;dom;)if(1==dom.nodeType)!changed&&
i<this.scrollTargets.length&&this.scrollTargets[i]==dom?i++:changed||(changed=this.scrollTargets.slice(0,i)),changed&&changed.push(dom),dom=dom.assignedSlot||dom.parentNode;else if(11==dom.nodeType)dom=dom.host;else break;i<this.scrollTargets.length&&!changed&&(changed=this.scrollTargets.slice(0,i));if(changed){for(let dom of this.scrollTargets)dom.removeEventListener("scroll",this.onScroll);for(let dom of this.scrollTargets=changed)dom.addEventListener("scroll",this.onScroll)}}ignore(f){if(!this.active)return f();
try{return this.stop(),f()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,observeOptions),this.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange),useCharData&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),this.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange),useCharData&&this.dom.removeEventListener("DOMCharacterDataModified",
this.onCharData))}clearSelection(){this.ignoreSelection.set(this.selectionRange)}clear(){this.observer.takeRecords();this.queue.length=0;this.clearSelection()}flushSoon(){0>this.delayedFlush&&(this.delayedFlush=window.setTimeout(()=>{this.delayedFlush=-1;this.flush()},20))}forceFlush(){0<=this.delayedFlush&&(window.clearTimeout(this.delayedFlush),this.delayedFlush=-1,this.flush())}flush(){if(!(0<=this.delayedFlush)){this.lastFlush=Date.now();var records=this.queue;for(var mut of this.observer.takeRecords())records.push(mut);
records.length&&(this.queue=[]);mut=this.selectionRange;mut=!this.ignoreSelection.eq(mut)&&hasSelection(this.dom,mut);if(0!=records.length||mut){var from=-1,to=-1,typeOver=!1;for(var record of records)if(records=this.readMutation(record))records.typeOver&&(typeOver=!0),-1==from?{from,to}=records:(from=Math.min(records.from,from),to=Math.max(records.to,to));record=this.view.state;if(-1<from||mut)this.onChange(from,to,typeOver);this.view.state==record&&(this.view.docView.dirty&&(this.ignore(()=>this.view.docView.sync()),
this.view.docView.dirty=0),this.view.docView.updateSelection());this.clearSelection()}}}readMutation(rec){let cView=this.view.docView.nearest(rec.target);if(!cView||cView.ignoreMutation(rec))return null;cView.markDirty();if("childList"==rec.type){let childBefore=findChild(cView,rec.previousSibling||rec.target.previousSibling,-1);rec=findChild(cView,rec.nextSibling||rec.target.nextSibling,1);return{from:childBefore?cView.posAfter(childBefore):cView.posAtStart,to:rec?cView.posBefore(rec):cView.posAtEnd,
typeOver:!1}}return{from:cView.posAtStart,to:cView.posAtEnd,typeOver:rec.target.nodeValue==rec.oldValue}}destroy(){this.stop();this.intersection&&this.intersection.disconnect();for(let dom of this.scrollTargets)dom.removeEventListener("scroll",this.onScroll);window.removeEventListener("scroll",this.onScroll);clearTimeout(this.parentCheck)}}class DOMReader{constructor(points,view){this.points=points;this.view=view;this.text="";this.lineBreak=view.state.lineBreak}readRange(start,end){if(start){for(var parent=
start.parentNode;;){this.findPointBefore(parent,start);this.readNode(start);let next=start.nextSibling;if(next==end)break;let view=ContentView.get(start),nextView=ContentView.get(next);if((view?view.breakAfter:isBlockElement(start))||(nextView?nextView.breakAfter:isBlockElement(next))&&("BR"!=start.nodeName||start.cmIgnore))this.text+=this.lineBreak;start=next}this.findPointBefore(parent,end)}}readNode(node){if(!node.cmIgnore){var view=ContentView.get(node);view=view&&view.overrideDOMText;var text;
null!=view?text=view.sliceString(0,void 0,this.lineBreak):3==node.nodeType?text=node.nodeValue:"BR"==node.nodeName?text=node.nextSibling?this.lineBreak:"":1==node.nodeType&&this.readRange(node.firstChild,null);null!=text&&(this.findPointIn(node,text.length),this.text+=text,browser.chrome&&13==this.view.inputState.lastKeyCode&&!node.nextSibling&&/\n\n$/.test(this.text)&&(this.text=this.text.slice(0,-1)))}}findPointBefore(node,next){for(let point of this.points)point.node==node&&node.childNodes[point.offset]==
next&&(point.pos=this.text.length)}findPointIn(node,maxLen){for(let point of this.points)point.node==node&&(point.pos=this.text.length+Math.min(point.offset,maxLen))}}class DOMPoint{constructor(node,offset){this.node=node;this.offset=offset;this.pos=-1}}class EditorView{constructor(config={}){this.plugins=[];this.editorAttrs={};this.contentAttrs={};this.bidiCache=[];this.updateState=2;this.measureScheduled=-1;this.measureRequests=[];this.contentDOM=document.createElement("div");this.scrollDOM=document.createElement("div");
this.scrollDOM.tabIndex=-1;this.scrollDOM.className="cm-scroller";this.scrollDOM.appendChild(this.contentDOM);this.announceDOM=document.createElement("div");this.announceDOM.style.cssText="position: absolute; top: -10000px";this.announceDOM.setAttribute("aria-live","polite");this.dom=document.createElement("div");this.dom.appendChild(this.announceDOM);this.dom.appendChild(this.scrollDOM);this._dispatch=config.dispatch||(tr=>this.update([tr]));this.dispatch=this.dispatch.bind(this);this.root=config.root||
document;this.viewState=new ViewState(config.state||state$jscomp$0.EditorState.create());this.plugins=this.state.facet(viewPlugin).map(spec=>(new PluginInstance(spec)).update(this));this.observer=new DOMObserver(this,(from,to,typeOver)=>{applyDOMChange(this,from,to,typeOver)},event=>{this.inputState.runScrollHandlers(this,event);this.observer.intersecting&&this.measure()});this.inputState=new InputState(this);this.docView=new DocView(this);this.mountStyles();this.updateAttrs();this.updateState=0;
ensureGlobalHandler();this.requestMeasure();config.parent&&config.parent.appendChild(this.dom)}get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return 0<this.inputState.composing}dispatch(...input){this._dispatch(1==input.length&&input[0]instanceof state$jscomp$0.Transaction?input[0]:this.state.update(...input))}update(transactions){if(0!=this.updateState)throw Error("Calls to EditorView.update are not allowed while an update is in progress");
let redrawn=!1;let state$1=this.state;for(update of transactions){if(update.startState!=state$1)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");state$1=update.state}if(state$1.facet(state$jscomp$0.EditorState.phrases)!=this.state.facet(state$jscomp$0.EditorState.phrases))return this.setState(state$1);var update=new ViewUpdate(this,state$1,transactions);try{this.updateState=2;let scrollTo=transactions.some(tr=>tr.scrollIntoView)?state$1.selection.main:
null;this.viewState.update(update,scrollTo);this.bidiCache=CachedOrder.update(this.bidiCache,update.changes);update.empty||this.updatePlugins(update);redrawn=this.docView.update(update);this.state.facet(styleModule)!=this.styleModules&&this.mountStyles();this.updateAttrs();this.showAnnouncements(transactions)}finally{this.updateState=0}(redrawn||scrollTo||this.viewState.mustEnforceCursorAssoc)&&this.requestMeasure();if(!update.empty)for(let listener of this.state.facet(updateListener))listener(update)}setState(newState){if(0!=
this.updateState)throw Error("Calls to EditorView.setState are not allowed while an update is in progress");this.updateState=2;try{for(let plugin of this.plugins)plugin.destroy(this);this.viewState=new ViewState(newState);this.plugins=newState.facet(viewPlugin).map(spec=>(new PluginInstance(spec)).update(this));this.docView=new DocView(this);this.inputState.ensureHandlers(this);this.mountStyles();this.updateAttrs();this.bidiCache=[]}finally{this.updateState=0}this.requestMeasure()}updatePlugins(update){let prevSpecs=
update.startState.facet(viewPlugin);var specs=update.state.facet(viewPlugin);if(prevSpecs!=specs){var newPlugins=[];for(let spec of specs)specs=prevSpecs.indexOf(spec),0>specs?newPlugins.push(new PluginInstance(spec)):(specs=this.plugins[specs],specs.mustUpdate=update,newPlugins.push(specs));for(let plugin of this.plugins)plugin.mustUpdate!=update&&plugin.destroy(this);this.plugins=newPlugins;this.inputState.ensureHandlers(this)}else for(newPlugins of this.plugins)newPlugins.mustUpdate=update;for(update=
0;update<this.plugins.length;update++)this.plugins[update]=this.plugins[update].update(this)}measure(){-1<this.measureScheduled&&cancelAnimationFrame(this.measureScheduled);this.measureScheduled=-1;let updated=null;try{for(let i$jscomp$0=0;;i$jscomp$0++){this.updateState=1;let changed=this.viewState.measure(this.docView,0<i$jscomp$0),measuring=this.measureRequests;if(!changed&&!measuring.length&&null==this.viewState.scrollTo)break;this.measureRequests=[];if(5<i$jscomp$0){console.warn("Viewport failed to stabilize");
break}let measured=measuring.map(m=>{try{return m.read(this)}catch(e){return logException(this.state,e),BadMeasure}}),update=new ViewUpdate(this,this.state);update.flags|=changed;updated?updated.flags|=changed:updated=update;this.updateState=2;update.empty||this.updatePlugins(update);this.updateAttrs();changed&&this.docView.update(update);for(let i=0;i<measuring.length;i++)if(measured[i]!=BadMeasure)try{measuring[i].write(measured[i],this)}catch(e){logException(this.state,e)}this.viewState.scrollTo&&
(this.docView.scrollPosIntoView(this.viewState.scrollTo.head,this.viewState.scrollTo.assoc),this.viewState.scrollTo=null);if(!(changed&4)&&0==this.measureRequests.length)break}}finally{this.updateState=0}this.measureScheduled=-1;if(updated&&!updated.empty)for(let listener of this.state.facet(updateListener))listener(updated)}get themeClasses(){return baseThemeID+" "+(this.state.facet(darkTheme)?baseDarkID:baseLightID)+" "+this.state.facet(theme)}updateAttrs(){var editorAttrs=combineAttrs(this.state.facet(editorAttributes),
{class:"cm-editor cm-wrap"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses});updateAttrs(this.dom,this.editorAttrs,editorAttrs);this.editorAttrs=editorAttrs;editorAttrs=combineAttrs(this.state.facet(contentAttributes),{spellcheck:"false",autocorrect:"off",autocapitalize:"off",contenteditable:String(this.state.facet(editable)),class:"cm-content",style:`${browser.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"});updateAttrs(this.contentDOM,this.contentAttrs,editorAttrs);
this.contentAttrs=editorAttrs}showAnnouncements(trs){let first=!0;for(let tr of trs)for(let effect of tr.effects)effect.is(EditorView.announce)&&(first&&(this.announceDOM.textContent=""),first=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=effect.value)}mountStyles(){this.styleModules=this.state.facet(styleModule);styleMod.StyleModule.mount(this.root,this.styleModules.concat(baseTheme).reverse())}readMeasured(){if(2==this.updateState)throw Error("Reading the editor layout isn't allowed during an update");
0==this.updateState&&-1<this.measureScheduled&&this.measure()}requestMeasure(request){0>this.measureScheduled&&(this.measureScheduled=requestAnimationFrame(()=>this.measure()));if(request){if(null!=request.key)for(let i=0;i<this.measureRequests.length;i++)if(this.measureRequests[i].key===request.key){this.measureRequests[i]=request;return}this.measureRequests.push(request)}}pluginField(field){let result=[];for(let plugin of this.plugins)plugin.update(this).takeField(field,result);return result}plugin(plugin){for(let inst of this.plugins)if(inst.spec==
plugin)return inst.update(this).value;return null}blockAtHeight(height,docTop){this.readMeasured();return this.viewState.blockAtHeight(height,ensureTop(docTop,this.contentDOM))}visualLineAtHeight(height,docTop){this.readMeasured();return this.viewState.lineAtHeight(height,ensureTop(docTop,this.contentDOM))}viewportLines(f,docTop){let {from,to}=this.viewport;this.viewState.forEachLine(from,to,f,ensureTop(docTop,this.contentDOM))}visualLineAt(pos,docTop=0){return this.viewState.lineAt(pos,docTop)}get contentHeight(){return this.viewState.contentHeight}moveByChar(start,
forward,by){return moveByChar(this,start,forward,by)}moveByGroup(start,forward){return moveByChar(this,start,forward,initial=>byGroup(this,start.head,initial))}moveToLineBoundary(start,forward,includeWrap=!0){a:{let line=this.state.doc.lineAt(start.head);if(includeWrap=includeWrap&&this.lineWrapping?this.coordsAtPos(0>start.assoc&&start.head>line.from?start.head-1:start.head):null){let editorRect=this.dom.getBoundingClientRect();includeWrap=this.posAtCoords({x:forward==(this.textDirection==exports.Direction.LTR)?
editorRect.right-1:editorRect.left+1,y:(includeWrap.top+includeWrap.bottom)/2});if(null!=includeWrap){forward=state$jscomp$0.EditorSelection.cursor(includeWrap,forward?-1:1);break a}}start=LineView.find(this.docView,start.head);forward=state$jscomp$0.EditorSelection.cursor(start?forward?start.posAtEnd:start.posAtStart:forward?line.to:line.from,forward?-1:1)}return forward}moveVertically(start,forward,distance){a:{var _a,startPos=start.head;var JSCompiler_inline_result=forward?1:-1;if(startPos==(forward?
this.state.doc.length:0))JSCompiler_inline_result=state$jscomp$0.EditorSelection.cursor(startPos);else{var startCoords=this.coordsAtPos(startPos);if(startCoords){let rect=this.dom.getBoundingClientRect();forward=null!==(_a=start.goalColumn)&&void 0!==_a?_a:startCoords.left-rect.left;_a=rect.left+forward;distance=null!==distance&&void 0!==distance?distance:this.defaultLineHeight>>1;for(let startY=0>JSCompiler_inline_result?startCoords.top:startCoords.bottom,extra=0;50>extra;extra+=10){startCoords=
posAtCoords(this,{x:_a,y:startY+(distance+extra)*JSCompiler_inline_result},JSCompiler_inline_result);if(null==startCoords)break;if(startCoords!=startPos){JSCompiler_inline_result=state$jscomp$0.EditorSelection.cursor(startCoords,void 0,void 0,forward);break a}}}({doc:distance}=this.state);_a=distance.lineAt(startPos);forward=this.state.tabSize;startCoords=start.goalColumn;start=0;if(null==startCoords){for(startPos=distance.iterRange(_a.from,startPos);!startPos.next().done;)start=text$jscomp$0.countColumn(startPos.value,
start,forward);startCoords=start*this.defaultCharacterWidth}else start=Math.round(startCoords/this.defaultCharacterWidth);if(0>JSCompiler_inline_result&&0==_a.from)JSCompiler_inline_result=state$jscomp$0.EditorSelection.cursor(0);else if(0<JSCompiler_inline_result&&_a.to==distance.length)JSCompiler_inline_result=state$jscomp$0.EditorSelection.cursor(_a.to);else{_a=distance.line(_a.number+JSCompiler_inline_result);JSCompiler_inline_result=_a.from;startPos=0;for(distance=distance.iterRange(_a.from,
_a.to);startPos>=start&&!distance.next().done;){const {offset,leftOver}=text$jscomp$0.findColumn(distance.value,startPos,start,forward);startPos=start-leftOver;JSCompiler_inline_result+=offset}JSCompiler_inline_result=state$jscomp$0.EditorSelection.cursor(JSCompiler_inline_result,void 0,void 0,startCoords)}}}return JSCompiler_inline_result}scrollPosIntoView(pos){this.viewState.scrollTo=state$jscomp$0.EditorSelection.cursor(pos);this.requestMeasure()}domAtPos(pos){return this.docView.domAtPos(pos)}posAtDOM(node,
offset=0){return this.docView.posFromDOM(node,offset)}posAtCoords(coords){this.readMeasured();return posAtCoords(this,coords)}coordsAtPos(pos,side=1){this.readMeasured();let rect=this.docView.coordsAt(pos,side);if(!rect||rect.left==rect.right)return rect;let line=this.state.doc.lineAt(pos),order=this.bidiSpans(line);pos=order[BidiSpan.find(order,pos-line.from,-1,side)];return flattenRect(rect,pos.dir==exports.Direction.LTR==0<side)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.heightOracle.direction}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(line){if(4096<
line.length)return[new BidiSpan(0,line.length,0)];let dir=this.textDirection;for(var entry of this.bidiCache)if(entry.from==line.from&&entry.dir==dir)return entry.order;entry=computeOrder(line.text,this.textDirection);this.bidiCache.push(new CachedOrder(line.from,line.to,dir,entry));return entry}get hasFocus(){var _a;return(document.hasFocus()||browser.safari&&(null===(_a=this.inputState)||void 0===_a?void 0:_a.lastContextMenu)>Date.now()-3E4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>
{focusPreventScroll(this.contentDOM);this.docView.updateSelection()})}destroy(){for(let plugin of this.plugins)plugin.destroy(this);this.inputState.destroy();this.dom.remove();this.observer.destroy();-1<this.measureScheduled&&cancelAnimationFrame(this.measureScheduled)}static domEventHandlers(handlers){return ViewPlugin.define(()=>({}),{eventHandlers:handlers})}static theme(spec,options){let prefix=styleMod.StyleModule.newName();spec=[theme.of(prefix),styleModule.of(buildTheme(`.${prefix}`,spec))];
options&&options.dark&&spec.push(darkTheme.of(!0));return spec}static baseTheme(spec){return state$jscomp$0.Prec.fallback(styleModule.of(buildTheme("."+baseThemeID,spec,lightDarkIDs)))}}EditorView.styleModule=styleModule;EditorView.inputHandler=inputHandler;EditorView.exceptionSink=exceptionSink;EditorView.updateListener=updateListener;EditorView.editable=editable;EditorView.mouseSelectionStyle=mouseSelectionStyle;EditorView.dragMovesSelection=dragMovesSelection$1;EditorView.clickAddsSelectionRange=
clickAddsSelectionRange;EditorView.decorations=decorations;EditorView.contentAttributes=contentAttributes;EditorView.editorAttributes=editorAttributes;EditorView.lineWrapping=EditorView.contentAttributes.of({"class":"cm-lineWrapping"});EditorView.announce=state$jscomp$0.StateEffect.define();let resizeDebounce=-1;const BadMeasure={};class CachedOrder{constructor(from,to,dir,order){this.from=from;this.to=to;this.dir=dir;this.order=order}static update(cache,changes){if(changes.empty)return cache;let result=
[],lastDir=cache.length?cache[cache.length-1].dir:exports.Direction.LTR;for(let i=Math.max(0,cache.length-10);i<cache.length;i++){let entry=cache[i];entry.dir!=lastDir||changes.touchesRange(entry.from,entry.to)||result.push(new CachedOrder(changes.mapPos(entry.from,1),changes.mapPos(entry.to,-1),entry.dir,entry.order))}return result}}const currentPlatform="undefined"==typeof navigator?"key":/Mac/.test(navigator.platform)?"mac":/Win/.test(navigator.platform)?"win":/Linux|X11/.test(navigator.platform)?
"linux":"key",handleKeyEvents=EditorView.domEventHandlers({keydown(event,view){return runHandlers(getKeymap(view.state),event,view,"editor")}}),keymap=state$jscomp$0.Facet.define({enables:handleKeyEvents}),Keymaps=new WeakMap;let storedPrefix=null;const CanHidePrimary=!browser.ios,selectionConfig=state$jscomp$0.Facet.define({combine(configs){return state$jscomp$0.combineConfig(configs,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(a,b)=>Math.min(a,b),drawRangeCursor:(a,b)=>a||b})}});
class Piece{constructor(left,top,width,height,className){this.left=left;this.top=top;this.width=width;this.height=height;this.className=className}draw(){let elt=document.createElement("div");elt.className=this.className;this.adjust(elt);return elt}adjust(elt){elt.style.left=this.left+"px";elt.style.top=this.top+"px";0<=this.width&&(elt.style.width=this.width+"px");elt.style.height=this.height+"px"}eq(p){return this.left==p.left&&this.top==p.top&&this.width==p.width&&this.height==p.height&&this.className==
p.className}}const drawSelectionPlugin=ViewPlugin.fromClass(class{constructor(view){this.view=view;this.rangePieces=[];this.cursors=[];this.measureReq={read:this.readPos.bind(this),write:this.drawSel.bind(this)};this.selectionLayer=view.scrollDOM.appendChild(document.createElement("div"));this.selectionLayer.className="cm-selectionLayer";this.selectionLayer.setAttribute("aria-hidden","true");this.cursorLayer=view.scrollDOM.appendChild(document.createElement("div"));this.cursorLayer.className="cm-cursorLayer";
this.cursorLayer.setAttribute("aria-hidden","true");view.requestMeasure(this.measureReq);this.setBlinkRate()}setBlinkRate(){this.cursorLayer.style.animationDuration=this.view.state.facet(selectionConfig).cursorBlinkRate+"ms"}update(update){let confChanged=update.startState.facet(selectionConfig)!=update.state.facet(selectionConfig);(confChanged||update.selectionSet||update.geometryChanged||update.viewportChanged)&&this.view.requestMeasure(this.measureReq);update.transactions.some(tr=>tr.scrollIntoView)&&
(this.cursorLayer.style.animationName="cm-blink"==this.cursorLayer.style.animationName?"cm-blink2":"cm-blink");confChanged&&this.setBlinkRate()}readPos(){let {state}=this.view,conf=state.facet(selectionConfig),rangePieces=state.selection.ranges.map(r=>r.empty?[]:measureRange(this.view,r)).reduce((a,b)=>a.concat(b)),cursors=[];for(let r of state.selection.ranges){var prim=r==state.selection.main;(r.empty?!prim||CanHidePrimary:conf.drawRangeCursor)&&(prim=measureCursor(this.view,r,prim))&&cursors.push(prim)}return{rangePieces,
cursors}}drawSel({rangePieces,cursors}){if(rangePieces.length!=this.rangePieces.length||rangePieces.some((p,i)=>!p.eq(this.rangePieces[i]))){this.selectionLayer.textContent="";for(let p of rangePieces)this.selectionLayer.appendChild(p.draw());this.rangePieces=rangePieces}if(cursors.length!=this.cursors.length||cursors.some((c,i)=>!c.eq(this.cursors[i]))){let oldCursors=this.cursorLayer.children;if(oldCursors.length!==cursors.length){this.cursorLayer.textContent="";for(const c of cursors)this.cursorLayer.appendChild(c.draw())}else cursors.forEach((c,
idx)=>c.adjust(oldCursors[idx]));this.cursors=cursors}}destroy(){this.selectionLayer.remove();this.cursorLayer.remove()}}),themeSpec={".cm-line":{"\x26 ::selection":{backgroundColor:"transparent !important"},"\x26::selection":{backgroundColor:"transparent !important"}}};CanHidePrimary&&(themeSpec[".cm-line"].caretColor="transparent !important");const hideNativeSelection=state$jscomp$0.Prec.override(EditorView.theme(themeSpec));class MatchDecorator{constructor(config){let {regexp,decoration,boundary}=
config;if(!regexp.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");this.regexp=regexp;this.getDeco="function"==typeof decoration?decoration:()=>decoration;this.boundary=boundary}createDeco(view){let build=new rangeset.RangeSetBuilder;for(let {from,to}of view.visibleRanges)iterMatches(view.state.doc,this.regexp,from,to,(a,b,m)=>build.add(a,b,this.getDeco(m,view,a)));return build.finish()}updateDeco(update,deco){let changeFrom=1E9,changeTo=-1;
update.docChanged&&update.changes.iterChanges((_f,_t,from,to)=>{to>update.view.viewport.from&&from<update.view.viewport.to&&(changeFrom=Math.min(from,changeFrom),changeTo=Math.max(to,changeTo))});return update.viewportChanged||1E3<changeTo-changeFrom?this.createDeco(update.view):-1<changeTo?this.updateRange(update.view,deco.map(update.changes),changeFrom,changeTo):deco}updateRange(view,deco,updateFrom,updateTo){for(let r of view.visibleRanges){var from$jscomp$0=Math.max(r.from,updateFrom);let to$jscomp$0=
Math.min(r.to,updateTo);if(to$jscomp$0>from$jscomp$0){let fromLine=view.state.doc.lineAt(from$jscomp$0),toLine=fromLine.to<to$jscomp$0?view.state.doc.lineAt(to$jscomp$0):fromLine,start=Math.max(r.from,fromLine.from),end=Math.min(r.to,toLine.to);if(this.boundary){for(;from$jscomp$0>fromLine.from;from$jscomp$0--)if(this.boundary.test(fromLine.text[from$jscomp$0-1-fromLine.from])){start=from$jscomp$0;break}for(;to$jscomp$0<toLine.to;to$jscomp$0++)if(this.boundary.test(toLine.text[to$jscomp$0-toLine.from])){end=
to$jscomp$0;break}}let ranges=[],m$jscomp$0;if(fromLine==toLine)for(this.regexp.lastIndex=start-fromLine.from;(m$jscomp$0=this.regexp.exec(fromLine.text))&&m$jscomp$0.index<end-fromLine.from;)from$jscomp$0=m$jscomp$0.index+fromLine.from,ranges.push(this.getDeco(m$jscomp$0,view,from$jscomp$0).range(from$jscomp$0,from$jscomp$0+m$jscomp$0[0].length));else iterMatches(view.state.doc,this.regexp,start,end,(from,to,m)=>ranges.push(this.getDeco(m,view,from).range(from,to)));deco=deco.update({filterFrom:start,
filterTo:end,filter:()=>!1,add:ranges})}}return deco}}const UnicodeRegexpSupport=null!=/x/.unicode?"gu":"g",Specials=RegExp("[\x00-\b\n--­؜​‎‏\u2028\u2029﻿￹-￼]",UnicodeRegexpSupport),Names={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8233:"paragraph separator",65279:"zero width no-break space",
65532:"object replacement"};let _supportsTabSize=null;const specialCharConfig=state$jscomp$0.Facet.define({combine(configs){configs=state$jscomp$0.combineConfig(configs,{render:null,specialChars:Specials,addSpecialChars:null});var _a;if(null==_supportsTabSize&&"undefined"!=typeof document&&document.body){let styles=document.body.style;_supportsTabSize=null!=(null!==(_a=styles.tabSize)&&void 0!==_a?_a:styles.MozTabSize)}if(configs.replaceTabs=!_supportsTabSize)configs.specialChars=new RegExp("\t|"+
configs.specialChars.source,UnicodeRegexpSupport);configs.addSpecialChars&&(configs.specialChars=new RegExp(configs.specialChars.source+"|"+configs.addSpecialChars.source,UnicodeRegexpSupport));return configs}});let _plugin=null;class SpecialCharWidget extends WidgetType{constructor(options,code){super();this.options=options;this.code=code}eq(other){return other.code==this.code}toDOM(view){var JSCompiler_inline_result=this.code;JSCompiler_inline_result=32<=JSCompiler_inline_result?"•":10==JSCompiler_inline_result?
"␤":String.fromCharCode(9216+JSCompiler_inline_result);view=view.state.phrase("Control character")+" "+(Names[this.code]||"0x"+this.code.toString(16));var custom=this.options.render&&this.options.render(this.code,view,JSCompiler_inline_result);if(custom)return custom;custom=document.createElement("span");custom.textContent=JSCompiler_inline_result;custom.title=view;custom.setAttribute("aria-label",view);custom.className="cm-specialChar";return custom}ignoreEvent(){return!1}}class TabWidget extends WidgetType{constructor(width){super();
this.width=width}eq(other){return other.width==this.width}toDOM(){let span=document.createElement("span");span.textContent="\t";span.className="cm-tab";span.style.width=this.width+"px";return span}ignoreEvent(){return!1}}const lineDeco=Decoration.line({attributes:{class:"cm-activeLine"}}),activeLineHighlighter=ViewPlugin.fromClass(class{constructor(view){this.decorations=this.getDeco(view)}update(update){if(update.docChanged||update.selectionSet)this.decorations=this.getDeco(update.view)}getDeco(view){let lastLineStart=
-1,deco=[];for(let r of view.state.selection.ranges){if(!r.empty)return Decoration.none;let line=view.visualLineAt(r.head);line.from>lastLineStart&&(deco.push(lineDeco.range(line.from)),lastLineStart=line.from)}return Decoration.set(deco)}},{decorations:v=>v.decorations});class Placeholder extends WidgetType{constructor(content){super();this.content=content}toDOM(){let wrap=document.createElement("span");wrap.className="cm-placeholder";wrap.style.pointerEvents="none";wrap.appendChild("string"==typeof this.content?
document.createTextNode(this.content):this.content);"string"==typeof this.content?wrap.setAttribute("aria-label","placeholder "+this.content):wrap.setAttribute("aria-hidden","true");return wrap}ignoreEvent(){return!1}}const __test={HeightMap,HeightOracle,MeasuredHeights,QueryType,ChangedRange,computeOrder,moveVisually};Object.defineProperty(exports,"Range",{enumerable:!0,get:function(){return rangeset.Range}});exports.BidiSpan=BidiSpan;exports.BlockInfo=BlockInfo;exports.Decoration=Decoration;exports.EditorView=
EditorView;exports.MatchDecorator=MatchDecorator;exports.PluginField=PluginField;exports.PluginFieldProvider=PluginFieldProvider;exports.ViewPlugin=ViewPlugin;exports.ViewUpdate=ViewUpdate;exports.WidgetType=WidgetType;exports.__test=__test;exports.drawSelection=function(config={}){return[selectionConfig.of(config),drawSelectionPlugin,hideNativeSelection]};exports.highlightActiveLine=function(){return activeLineHighlighter};exports.highlightSpecialChars=function(config={}){return[specialCharConfig.of(config),
specialCharPlugin()]};exports.keymap=keymap;exports.logException=logException;exports.placeholder=function(content){return ViewPlugin.fromClass(class{constructor(view){this.view=view;this.placeholder=Decoration.set([Decoration.widget({widget:new Placeholder(content),side:1}).range(0)])}get decorations(){return this.view.state.doc.length?Decoration.none:this.placeholder}},{decorations:v=>v.decorations})};exports.runScopeHandlers=function(view,event,scope){return runHandlers(getKeymap(view.state),event,
view,scope)}}
//# sourceMappingURL=module$node_modules$$codemirror$view$dist$index_cjs.js.map
